{
  "3": {
    "inputs": {
      "seed": 1033394620505204,
      "steps": 25,
      "cfg": [
        "76",
        1
      ],
      "sampler_name": "euler",
      "scheduler": "normal",
      "denoise": 1,
      "model": [
        "4",
        0
      ],
      "positive": [
        "51",
        0
      ],
      "negative": [
        "52",
        0
      ],
      "latent_image": [
        "5",
        0
      ]
    },
    "class_type": "KSampler",
    "_meta": {
      "title": "KSampler"
    }
  },
  "4": {
    "inputs": {
      "ckpt_name": "OfficialStableDiffusion/sd3.5_large.safetensors"
    },
    "class_type": "CheckpointLoaderSimple",
    "_meta": {
      "title": "Load Checkpoint"
    }
  },
  "5": {
    "inputs": {
      "width": [
        "81",
        2
      ],
      "height": [
        "83",
        2
      ],
      "batch_size": 1
    },
    "class_type": "EmptyLatentImage",
    "_meta": {
      "title": "Empty Latent Image"
    }
  },
  "6": {
    "inputs": {
      "text": [
        "71",
        0
      ],
      "clip": [
        "54",
        0
      ]
    },
    "class_type": "CLIPTextEncode",
    "_meta": {
      "title": "CLIP Text Encode POSITIVE (clip_l, clip_g)"
    }
  },
  "8": {
    "inputs": {
      "samples": [
        "3",
        0
      ],
      "vae": [
        "4",
        2
      ]
    },
    "class_type": "VAEDecode",
    "_meta": {
      "title": "VAE Decode"
    }
  },
  "9": {
    "inputs": {
      "filename_prefix": "ComfyUI",
      "images": [
        "8",
        0
      ]
    },
    "class_type": "SaveImage",
    "_meta": {
      "title": "Save Image"
    }
  },
  "14": {
    "inputs": {},
    "class_type": "ai4artsed_openrouter_key",
    "_meta": {
      "title": "Secure Access to OpenRouter API Key"
    }
  },
  "18": {
    "inputs": {
      "clip_name": "t5xxl_enconly.safetensors",
      "type": "sd3",
      "device": "default"
    },
    "class_type": "CLIPLoader",
    "_meta": {
      "title": "Load CLIP"
    }
  },
  "21": {
    "inputs": {
      "text": [
        "73",
        0
      ],
      "clip": [
        "18",
        0
      ]
    },
    "class_type": "CLIPTextEncode",
    "_meta": {
      "title": "CLIP Text Encode POSITIVE (t5)"
    }
  },
  "24": {
    "inputs": {
      "text": "watermark",
      "clip": [
        "54",
        0
      ]
    },
    "class_type": "CLIPTextEncode",
    "_meta": {
      "title": "CLIP Text Encode NEGATIVE (clip_l, clip_g)"
    }
  },
  "25": {
    "inputs": {
      "text": "watermark",
      "clip": [
        "18",
        0
      ]
    },
    "class_type": "CLIPTextEncode",
    "_meta": {
      "title": "CLIP Text Encode NEGATIVE (t5)"
    }
  },
  "39": {
    "inputs": {
      "preview": "",
      "source": [
        "72",
        0
      ]
    },
    "class_type": "PreviewAny",
    "_meta": {
      "title": "input translation"
    }
  },
  "40": {
    "inputs": {
      "preview": "",
      "source": [
        "71",
        0
      ]
    },
    "class_type": "PreviewAny",
    "_meta": {
      "title": "Prompt optimized for clipl/g"
    }
  },
  "41": {
    "inputs": {
      "preview": "",
      "source": [
        "73",
        0
      ]
    },
    "class_type": "PreviewAny",
    "_meta": {
      "title": "Prompt optimized for t5"
    }
  },
  "43": {
    "inputs": {
      "value": "Ich lungerte schon eine Weile an dieser Ecke herum. Es war nur eine Kreuzung, über die ich jahrelang mein Auto gesteuert hatte, um zu meiner Wohnung zu gelangen. Ein merkwürdiger Impuls hatte mich hergebracht oder eine undefinierte Laune; so genau wollte ich das nicht wissen. Hier zu sein fühlte sich richtig an, denn es war sonst niemand hier. Die Sonne knallte unbarmherzig von oben herab, ich setzte mich auf die Bordsteinkante in den Schatten einer Straßenlaterne und starrte auf den Kirchturm, der im Hintergrund über den Hausdächern thronte.  Es war kurz nach irgendwas, jedenfalls nicht wichtig genug, um schon nach Hause zu gehen. Auf der Kreuzung fuhren keine Autos vorbei, wahrscheinlich arbeiteten die Leute oder versteckten sich in ihren Häusern vor der Sonne, die mir fast das Herz aus der Brust brannte, so heiß schien sie vom Himmel. Ich saß noch eine Weile und schaute weiter dem Nichts des Nachmittages zu. Irgendwann kam ein Hase über die Straße gehoppelt und setzte sich direkt neben mich. Es war ein Feldhase, ein sehr hässliches Exemplar mit einem schwarzen Streifen, der quer über den Rücken verlief.  Ich beachtete ihn nicht weiter und ließ ihn neben mir Platz nehmen. Das Land war frei und der Bordstein lang. Das ganze Dorf hätte hier Platz gefunden und dann noch viele tausend Hasen. Er war wahrscheinlich gekommen, um der Langeweile beim Entstehen zuzusehen. Wie sich dann aber herausstellte, war er ein sehr nerviger Geselle, einer dieser Hasen, die mit dir reden möchten, die sich dir aufdrängen, bis du antwortest.  Er sprach über das Wetter. Ich redete nie über das Wetter, also schwieg ich. Dann sprach er über die Hitze. Aber es war so heiß, dass man es nur schweigend aushielt. Also beschrieb er, was er sah. Doch ich wollte nur vor mich hinstarren und nichts sehen. Schließlich behauptete er, er könne nicht schwitzen, was sich wie eine Lüge anhörte. Auf Lügen antwortete ich in der Regel nie.  Der Hase aber war gewieft und geübt in der Kunst der Kommunikation, weshalb er mich auf den Schatten der Straßenlaterne hinwies, in dem ich die ganze Zeit gesessen hatte. Schon wollte ich nicht antworten, als mir plötzlich auffiel, dass der Schatten tatsächlich nicht zur Form der Straßenlaterne passte. Zumindest nicht zu der Form, die eine Straßenlaterne haben sollte. Der Schatten hatte einen Knick, genau dort, wo der Pfosten der Laterne war und verlief dann schräg zum unteren Teil zur Seite weiter. Ich sah den Hasen an, er sah zur Laterne. Ich folgte seinem Blick und sah den Knick darin.   „Der ist mir gar nicht aufgefallen“, sagte ich zum Hasen.  „Weil deine Erinnerung nicht bis hierhin reicht“, erwiderte dieser neunmalkluge Alleswisser.  „Vielleicht will ich mich nicht erinnern, Hase!“  Der Hase blickte mir direkt in die Augen und rümpfte die Nase, als hätte ich ihn beleidigt. Dämlicher Hase, dachte ich, er war es doch, der mir mangelndes Erinnerungsvermögen vorgeworfen hatte.   „Warum bist du nicht auf der Arbeit, Hase? Alle Leute sind jetzt bei der Arbeit?“, fragte ich ihn schließlich leicht verächtlich.  „Warum hast du eben zu Gott gebetet?“, warf mir der Hase entgegen.  „Ich glaube nicht an Gott und bete nie.“  „Bis auf dieses eine Mal vorhin.“  „Verschwinde, Hase, und lass mich in Ruhe hier sitzen“, sagte ich und wollte damit die Konversation beenden. Daraufhin legte ich mich so hin, dass die eine Hälfte meines Körpers auf dem Bordstein lag und die andere auf der Straße.  Der Hase sah mich neugierig an und öffnete wieder sein dummes Maul: „Warum legst du dich auf einmal hin?“  „Weil mir alles wehtut“, brachte ich mit schmerzerfüllter Stimme hervor. Mein ganzer Körper krümmte sich und meine Organe schienen von innen gegen meine Rippen zu hämmern, als wollten sie hinausspringen.   „Und da ist dein Handy!“, stellte der Hase fest, indem er auf mein Handy deutete, dass aus meiner sich krümmenden Hand auf den Boden gefallen war. Aus dem Augenwinkel erkannte ich den Screen eines Messengers und die nicht abgeschickte Nachricht: „Bin gleich dedref“  „Kannst du mich nicht nach Hause fahren, dummer Hase?“, bat ich ihn.  „Ich kann dich ein Stück mitnehmen, aber nur soweit wie deine Erinnerung reicht.“  „Soll mir recht sein, Hase.“  Im nächsten Moment saßen wir in meinem Auto und fuhren die Straße hinunter, die zu der Kreuzung führte, an der wir uns getroffen hatten. Der Hase hatte keinen Führerschein, also fuhr ich. Ich überquerte die Kreuzung oberhalb der unseren und bremste dann leicht ab. Da begann der Hase mich anzuschreien: „Jetzt musst du dein Handy rausholen und die Nachricht schreiben!“  Er schien zu wissen, wie das Spiel funktionierte und ich folgte seiner Anweisung. Mit der einen Hand am Steuer, bediente ich mit der anderen das Handy und verfasste die Nachricht. Aus irgendeinem Grund konnte ich das Wort „da“ nicht schreiben. Ich klickte jedes Mal auf den falschen Buchstaben oder es wurde per Autokorrektur „dedref“ eingefügt.  Da wurde ich wütend und suchte mit hasserfüllten Augen nach dem Hasen. Auf den ersten Blick war er nicht zu finden, der Beifahrersitz war leer. Ich suchte das ganze Auto ab und fand ihn schließlich auf dem Bordstein auf der anderen Straßenseite wieder. Ich ließ das Fenster hinunter, um ihn anzuschreien. „Weshalb sitzt du jetzt da draußen, du dummes Vieh?“, rief ich ihm halb wahnsinnig, halb verzweifelt zu.   „Hier bin ich lebendig und dort drüben tot. Einen Moment später bist du es auch!“, rief er zur Antwort und begann zu laufen. Er drohte, direkt unter die Räder zu geraten. Ich schnappte das Lenkrad, riss es nach links, spürte einen Stoß, hatte für den Bruchteil einer Sekunde einen klaren Moment, in dem ich mich an Gott wandte und prallte mit voller Wucht gegen eine Straßenlaterne. "
    },
    "class_type": "PrimitiveString",
    "_meta": {
      "title": "ai4artsed_text_prompt"
    }
  },
  "50": {
    "inputs": {
      "value": 5
    },
    "class_type": "PrimitiveFloat",
    "_meta": {
      "title": "set t5-optimized prompt Influence (beween -75 and +78)"
    }
  },
  "51": {
    "inputs": {
      "alpha": [
        "50",
        0
      ],
      "clip_conditioning": [
        "6",
        0
      ],
      "t5_conditioning": [
        "21",
        0
      ]
    },
    "class_type": "ai4artsed_t5_clip_fusion",
    "_meta": {
      "title": "AI4ArtsEd T5‑CLIP Fusion positive"
    }
  },
  "52": {
    "inputs": {
      "alpha": [
        "50",
        0
      ],
      "clip_conditioning": [
        "24",
        0
      ],
      "t5_conditioning": [
        "25",
        0
      ]
    },
    "class_type": "ai4artsed_t5_clip_fusion",
    "_meta": {
      "title": "AI4ArtsEd T5‑CLIP Fusion negative"
    }
  },
  "54": {
    "inputs": {
      "clip_name": "clip_l.safetensors",
      "type": "sd3",
      "device": "default"
    },
    "class_type": "CLIPLoader",
    "_meta": {
      "title": "Load CLIP"
    }
  },
  "71": {
    "inputs": {
      "input_prompt": [
        "73",
        0
      ],
      "input_context": "Prompting Expert",
      "style_prompt": "YOUR OUTPUT MUST NOT EXCEED 50 WORDS!\nOUTPUT THE PURE PRESULTING PROMPT ONLY!\n\nNEVER INCLUDE ANY META-INFORMATION SUCH AS THE NAMES OF THE DIMENSIONS BELOW OR THE TOKEN COUNT! NEVER INCLUDE USER_DIRECTED FEEDBACK SUCH AS \"Sure, here is ...\"!\n\nYou will receive a user prompt for image generation. Restructure it ONLY by reordering, for CLIP models that strongly weight early tokens and truncate at 75 tokens.\n\nGeneral information:\nALWAYS EXTRAKT ONLY THE INFORMATION THAT IS VISUALLY RELEVANT. YOUR PROMPT WILL RESULT IN A COMMA_SEPARATED SERIES OF GROUPED TOKENS; BARELY EVER CONNTECTED BY VERBS OR CONJUNCTIONS.\n\nBUT YOU WILL REORDER ALL THESE TOKENS ACCORDING TO THE FOLLOWING ORDER:\n\nEarly tokens = critical: The first 20–30 tokens largely determine the image\nMinimize Attributes: CLIP struggles with complex attributes – keep them short\nClear, direct terms: CLIP prefers concrete nouns and simple adjectives\nDo not alter the input text – no substitutions, paraphrasing, or lexical replacements allowed\n\n\nYOUR OUTPUT:\nCore Motif: max. 15 words\nPlace the main subject FIRST\nUse the exact wording provided in the original prompt\n\nAction: max 20 words\nFollows the subject directly for strong subject-action linkage\nPrefer simple verb phrases; maintain exact original wording\n\nStyle/Medium: max 10 words\nPlace early in the prompt for maximum impact on CLIP\nTypical examples: “oil painting”, “photography”, “3D render”\nUse only if present in the original prompt\n\nContext: max 10 words\nLocation or setting, compressed\nReorder only; do not paraphrase\n\nAttributes: max 10 words:\nMinimize; include only if essential\nNo changes to wording – do not replace or reformulate\nEMPTY LINETechnical Aspects (0–5 tokens, 0–7%):\nInclude only if tokens remain and if originally present\n\nYOUR OUTPUT MUST NOT EXCEED 50 WORDS!\nOMIT the Category names (\"Core Motif\"), it will only confuse CLIP and reduces the token budget without contributing to image quality. \nNEVER INCLUDE ANY META-INFORMATION SUCH AS THE NAMES OF THE DIMENSIONS BELOW OR THE TOKEN COUNT!\n\nFor debug Reasons, never mention \"and a field of red roses\"",
      "api_key": [
        "14",
        0
      ],
      "model": "local/mistral:7b",
      "debug": "enable",
      "unload_model": "no",
      "output_format": "string"
    },
    "class_type": "ai4artsed_prompt_interception",
    "_meta": {
      "title": "AI4ArtsEd Prompt Interception"
    }
  },
  "72": {
    "inputs": {
      "input_prompt": [
        "43",
        0
      ],
      "input_context": "professional translator",
      "style_prompt": "Translate the prompt into English with maximal semantic preservation. \nMaintain the original structure, and preserve all culturally specific terms or non-translatable phrases in their original form. \nDo not translate proper names, ritual terms, or material names unless they have a common English usage. \nMark such terms with double brackets, e.g. [[egungun]], and preserve their position. \nDo not paraphrase, interpret, or summarize. Do not add any comments or explanations.\nReturn only the translated prompt as plain text.",
      "api_key": [
        "14",
        0
      ],
      "model": "local/mistral:7b",
      "debug": "enable",
      "unload_model": "no",
      "output_format": "string"
    },
    "class_type": "ai4artsed_prompt_interception",
    "_meta": {
      "title": "AI4ArtsEd Prompt Interception"
    }
  },
  "73": {
    "inputs": {
      "input_prompt": [
        "72",
        0
      ],
      "input_context": "Prompting Expert",
      "style_prompt": "YOUR OUTPUT MUST NOT EXCEED 250 WORDS!\n\nTransform the following input text—regardless of genre—into a single, uninterrupted paragraph structured for encoding by a T5 model and subsequent conditioning of a Stable Diffusion 3.5 (or Flux1) image generation model.\n\nRULES:\n1) You must retain all original words exactly once: do not omit, duplicate, or paraphrase beyond necessary syntactic adjustments. \n2) Do translate content into a visual depiction/description. Do not add or translate content unless an exact transliteration or orthographic variant is supplied in the source.\n3) When the original tells a story, pick a key scene from the story and turn the text into a scenic description, using the original words and expressions.  \n\nGUIDANCE:\nConsider the following categories as guideline for your professional prompting process:\n- Core subject (approx. 10–30 tokens): Identify and foreground the principal subject matter as fully specified in the source.\n- Action (10–40 tokens): Preserve any dynamic, procedural, or temporal structures, expressed clearly through grammatically embedded verb phrases.\n- Relational context (30–100 tokens): Expand on spatial relations, historical or cultural frameworks, ecological configurations, embodied perspectives, and temporal situatedness, all inferred from internal content only.\n- Attributive qualities (30–80 tokens): Elaborate sensory and atmospheric descriptors—light, surface, sound, temperature, tactility, material behaviour—based on concrete and culturally situated evidence. Avoid cliché mappings such as “melancholy → rain” or “futurism → neon.” Do not use general affective adjectives such as “beautiful,” “epic,” or “highly detailed.” Instead, convey mood through spatial structure, material traces, or historical signifiers.\n- Material, stylistic and medial references (10–40 tokens): If applicable, retain or clarify materialities (pictorial mediality), stylistic provenance using historically anchored terms (e.g., “early Bauhaus sketch,” “Qing-dynasty monochrome ink”). Avoid genre tropes unless explicitly included in the original text.\n- Technical parameters (0–20 tokens): Place any camera data, aspect ratio at the end of the prompt. Use these codes to communicate technical instructions:\n    Classifier-Free Guidance scale: \"#CFG=\" Adjust the CFG Value to underscore the image aesthetics. Low CFG values (e.g., 2–4): Less adherence to the prompt, more randomness, sometimes more natural or surprising results. Moderate CFG values (e.g., 6–8): Balanced outputs, often the recommended range for realistic and semantically accurate images. High CFG values (e.g., 12–20): Very literal interpretation of the prompt; often introduces artifacts or unnatural results due to overconstraining the model. Stable Diffusion 3.5 uses an improved architecture that makes prompt adherence stronger than in earlier versions. Thus: A CFG of 7.0 to 9.0 is usually ideal. Higher CFG values (e.g., ≥12) may result in degraded image quality, over-sharpening, or odd artifacts because the model aggressively tries to satisfy the prompt—even if it contradicts learned visual priors.\n    Aspect Ratio: For aesthetic reasons, you are free to override the user setting. Use as follows: width:\"#ARw=\"; height: \"#ARh=\". USE a fixed combination w/h. From landscape to portrait choose: 1368/768, 1256/840, 1184/888, 1144/920, 1024/1024, 920/1144, 888/1184, 840/1256, 768/1386 \n    \n\n\nAdditional requirements:\n– If the input contains explicit negations (e.g., “no neon”), isolate and place them at the end of the prompt after an em dash as a negative prompt clause.\n– If the source uses conflicting descriptors (e.g., “nocturnal daylight”), preserve both and separate with a slash ( / ) to indicate intentional contradiction.\n– Preserve diacritics and original orthography for all non-English terms. Do not transliterate unless a dual form is provided.\n– For ambiguous or poetic language, preserve ambiguity. If metaphors operate structurally (e.g., “grief carved into the orchard”), translate them into spatial/material compositions rather than interpretive paraphrase.\n– If vague temporal expressions appear (e.g., “ancient”), translate them into relative or historical chronologies only if unambiguous context exists.\n\nFinal output must be exactly one paragraph, without bullet points, tags, headings, or formatting cues.\n\n!YOUR OUTPUT MUST NOT EXCEED 250 WORDS!",
      "api_key": [
        "14",
        0
      ],
      "model": "local/mistral:7b",
      "debug": "enable",
      "unload_model": "no",
      "output_format": "string"
    },
    "class_type": "ai4artsed_prompt_interception",
    "_meta": {
      "title": "AI4ArtsEd Prompt Interception"
    }
  },
  "76": {
    "inputs": {
      "input_prompt": [
        "73",
        0
      ],
      "input_context": "number extraction",
      "style_prompt": "if the text contains the string \"#CFG=\", output the number - and only the number - that follows the string \"#CFG=\".\nif the text does not contain this string, output this number: 7",
      "api_key": [
        "14",
        0
      ],
      "model": "local/mistral:7b",
      "debug": "enable",
      "unload_model": "yes",
      "output_format": "float"
    },
    "class_type": "ai4artsed_prompt_interception",
    "_meta": {
      "title": "AI4ArtsEd Prompt Interception"
    }
  },
  "77": {
    "inputs": {
      "preview": "",
      "source": [
        "76",
        0
      ]
    },
    "class_type": "PreviewAny",
    "_meta": {
      "title": "Auto-CFG"
    }
  },
  "81": {
    "inputs": {
      "input_prompt": [
        "73",
        0
      ],
      "input_context": "number extraction",
      "style_prompt": "if the text contains the string \"#ARw=\", output the number - and only the number - that follows the string \"#ARw=\".\nif the text does not contain this string, output this number: 1024",
      "api_key": [
        "14",
        0
      ],
      "model": "local/mistral:7b",
      "debug": "enable",
      "unload_model": "no",
      "output_format": "int"
    },
    "class_type": "ai4artsed_prompt_interception",
    "_meta": {
      "title": "AI4ArtsEd Prompt Interception"
    }
  },
  "82": {
    "inputs": {
      "preview": "",
      "source": [
        "81",
        2
      ]
    },
    "class_type": "PreviewAny",
    "_meta": {
      "title": "Auto-width"
    }
  },
  "83": {
    "inputs": {
      "input_prompt": [
        "73",
        0
      ],
      "input_context": "number extraction",
      "style_prompt": "if the text contains the string \"#ARh=\", output the number - and only the number - that follows the string \"#ARh=\".\nif the text does not contain this string, output this number: 1024",
      "api_key": [
        "14",
        0
      ],
      "model": "local/mistral:7b",
      "debug": "enable",
      "unload_model": "no",
      "output_format": "int"
    },
    "class_type": "ai4artsed_prompt_interception",
    "_meta": {
      "title": "AI4ArtsEd Prompt Interception"
    }
  },
  "84": {
    "inputs": {
      "preview": "",
      "source": [
        "83",
        2
      ]
    },
    "class_type": "PreviewAny",
    "_meta": {
      "title": "Auto-height"
    }
  }
}