{
  "name": "output_image_flux2_img2img",
  "type": "output_chunk",
  "backend_type": "comfyui",
  "execution_mode": "legacy_workflow",
  "media_type": "image",
  "description": "Flux2 Dev IMG2IMG - High-quality 20-step image transformation with text guidance",

  "workflow": {
    "3": {
      "inputs": {
        "seed": 468029244405114,
        "steps": 20,
        "cfg": 1,
        "sampler_name": "euler",
        "scheduler": "normal",
        "denoise": 0.75,
        "model": ["4", 0],
        "positive": ["6", 0],
        "negative": ["7", 0],
        "latent_image": ["88", 0]
      },
      "class_type": "KSampler",
      "_meta": {
        "title": "KSampler"
      }
    },
    "4": {
      "inputs": {
        "ckpt_name": "Flux1/flux2_dev_fp8mixed.safetensors"
      },
      "class_type": "CheckpointLoaderSimple",
      "_meta": {
        "title": "Load Flux2 Checkpoint"
      }
    },
    "6": {
      "inputs": {
        "text": ["26", 0],
        "clip": ["45", 0]
      },
      "class_type": "CLIPTextEncode",
      "_meta": {
        "title": "CLIP Text Encode (Positive Prompt)"
      }
    },
    "7": {
      "inputs": {
        "text": "text, watermark",
        "clip": ["45", 0]
      },
      "class_type": "CLIPTextEncode",
      "_meta": {
        "title": "CLIP Text Encode (Negative Prompt)"
      }
    },
    "8": {
      "inputs": {
        "samples": ["3", 0],
        "vae": ["41", 0]
      },
      "class_type": "VAEDecode",
      "_meta": {
        "title": "VAE Decode"
      }
    },
    "9": {
      "inputs": {
        "filename_prefix": "ai4artsed_flux2_img2img",
        "images": ["8", 0]
      },
      "class_type": "SaveImage",
      "_meta": {
        "title": "Save Image"
      }
    },
    "41": {
      "inputs": {
        "vae_name": "Flux/flux2-vae.safetensors"
      },
      "class_type": "VAELoader",
      "_meta": {
        "title": "Load VAE"
      }
    },
    "45": {
      "inputs": {
        "clip_name": "mistral_3_small_flux2_fp8.safetensors",
        "type": "flux2",
        "device": "default"
      },
      "class_type": "CLIPLoader",
      "_meta": {
        "title": "Load Mistral 3 CLIP"
      }
    },
    "26": {
      "inputs": {
        "value": ["37", 0]
      },
      "class_type": "PrimitiveString",
      "_meta": {
        "title": "ai4artsed_text_prompt"
      }
    },
    "37": {
      "inputs": {
        "value": ""
      },
      "class_type": "PrimitiveStringMultiline",
      "_meta": {
        "title": "Prompt Input"
      }
    },
    "78": {
      "inputs": {
        "image": ""
      },
      "class_type": "LoadImage",
      "_meta": {
        "title": "Load Input Image"
      }
    },
    "93": {
      "inputs": {
        "upscale_method": "lanczos",
        "megapixels": 1,
        "image": ["78", 0]
      },
      "class_type": "ImageScaleToTotalPixels",
      "_meta": {
        "title": "ImageScaleToTotalPixels (1 Megapixel)"
      }
    },
    "88": {
      "inputs": {
        "pixels": ["93", 0],
        "vae": ["41", 0]
      },
      "class_type": "VAEEncode",
      "_meta": {
        "title": "VAE Encode Input Image"
      }
    }
  },

  "input_mappings": {
    "input_image": {
      "node_id": "78",
      "field": "inputs.image",
      "source": "{{INPUT_IMAGE}}",
      "description": "Path to input image for Flux2 IMG2IMG transformation"
    },
    "prompt": {
      "node_id": "37",
      "field": "inputs.value",
      "source": "{{PREVIOUS_OUTPUT}}",
      "description": "Text prompt describing desired transformation"
    },
    "negative_prompt": {
      "node_id": "7",
      "field": "inputs.text",
      "default": "text, watermark",
      "description": "Negative prompt - what to avoid"
    },
    "seed": {
      "node_id": "3",
      "field": "inputs.seed",
      "default": 468029244405114,
      "description": "Seed for reproducibility"
    },
    "steps": {
      "node_id": "3",
      "field": "inputs.steps",
      "default": 20,
      "description": "Number of sampling steps (20 recommended for Flux2)"
    },
    "cfg": {
      "node_id": "3",
      "field": "inputs.cfg",
      "default": 1,
      "description": "CFG scale (Flux2 uses low CFG)"
    },
    "denoise": {
      "node_id": "3",
      "field": "inputs.denoise",
      "default": 0.75,
      "description": "Denoise strength (0.7-0.9 for IMG2IMG, lower=more original image preserved)"
    },
    "megapixels": {
      "node_id": "93",
      "field": "inputs.megapixels",
      "default": 2.5,
      "description": "Input image scaling (2.5 = ~1600x1600)"
    }
  },

  "output_mapping": {
    "node_id": "9",
    "output_type": "image",
    "format": "png",
    "field": "filename_prefix",
    "description": "SaveImage node that outputs the generated image"
  },

  "meta": {
    "img2img": true,
    "estimated_duration_seconds": "40-80",
    "requires_gpu": true,
    "gpu_vram_mb": 18000,
    "model_files": {
      "checkpoint": "flux2_dev_fp8mixed.safetensors",
      "clip": "mistral_3_small_flux2_fp8.safetensors",
      "vae": "flux2-vae.safetensors"
    },
    "recommended_resolution": "1024x1024",
    "supported_resolutions": [
      "768x768",
      "1024x1024",
      "1280x768",
      "768x1280",
      "1536x1024",
      "1024x1536"
    ],
    "notes": "Flux2 Dev IMG2IMG: High-quality image-to-image transformation using standard ComfyUI nodes. Uses CheckpointLoaderSimple for easier model loading. The input image guides the generation while allowing creative freedom based on the text prompt. Uses 20 sampling steps with Euler sampler. Denoise=0.75 provides good balance between preserving original image and applying transformations. Excellent for creative transformations like 'change the sky', 'add objects', 'transform style'. Better than QWEN for natural language understanding and complex edits.",
    "optimization_instruction": "Output a natural language description of the desired transformation. Flux2 understands context and can handle complex instructions. Examples: 'Transform the sky to a dramatic sunset with orange and pink clouds', 'Add a forest of pine trees in the background', 'Change the style to a vintage 1970s photograph', 'Make the scene take place at night with street lights'. Can be 1-3 sentences. Flux2 excels at understanding 'only change X' instructions. For multilingual input, output in the SAME LANGUAGE as input."
  }
}
