{
  "name": "output_audio_acestep_instrumental",
  "type": "output_chunk",
  "backend_type": "comfyui",
  "media_type": "audio",
  "description": "AceStep Instrumental Music Generation (prompt only, no lyrics)",

  "workflow": {
    "125": {
      "inputs": {
        "model": ["131", 0],
        "operation": ["132", 0]
      },
      "class_type": "LatentApplyOperationCFG"
    },
    "128": {
      "inputs": {
        "samples": ["136", 0],
        "vae": ["133", 2]
      },
      "class_type": "VAEDecodeAudio"
    },
    "130": {
      "inputs": {
        "conditioning": ["137", 0]
      },
      "class_type": "ConditioningZeroOut"
    },
    "131": {
      "inputs": {
        "shift": 5.0,
        "model": ["133", 0]
      },
      "class_type": "ModelSamplingSD3"
    },
    "132": {
      "inputs": {
        "multiplier": 1.0
      },
      "class_type": "LatentOperationTonemapReinhard"
    },
    "133": {
      "inputs": {
        "ckpt_name": "ace_step_v1_3.5b.safetensors"
      },
      "class_type": "CheckpointLoaderSimple"
    },
    "134": {
      "inputs": {
        "seconds": 90,
        "batch_size": 1
      },
      "class_type": "EmptyAceStepLatentAudio"
    },
    "136": {
      "inputs": {
        "seed": -1,
        "steps": 300,
        "cfg": 5,
        "sampler_name": "euler",
        "scheduler": "simple",
        "denoise": 0.87,
        "model": ["125", 0],
        "positive": ["137", 0],
        "negative": ["130", 0],
        "latent_image": ["134", 0]
      },
      "class_type": "KSampler"
    },
    "137": {
      "inputs": {
        "tags": "{{PROMPT}}",
        "lyrics": "[instrumental]\\n[break down]\\n[drum fill]\\n[chopped samples]\\n",
        "lyrics_strength": 0.99,
        "clip": ["133", 1]
      },
      "class_type": "TextEncodeAceStepAudio"
    },
    "140": {
      "inputs": {
        "filename_prefix": "audio/ComfyUI",
        "quality": "320k",
        "audio": ["128", 0]
      },
      "class_type": "SaveAudioMP3"
    }
  },

  "input_mappings": {
    "PROMPT": {
      "source": "{{PREVIOUS_OUTPUT}}",
      "description": "Music description/tags from Stage 2 interception"
    }
  },

  "output_mapping": {
    "node_id": "140",
    "output_type": "audio",
    "format": "mp3",
    "field": "filename_prefix",
    "description": "SaveAudioMP3 node that outputs the generated audio"
  },

  "meta": {
    "model": "ace_step_v1_3.5b.safetensors",
    "backend": "comfyui",
    "requires_gpu": true,
    "estimated_time_seconds": 180,
    "source_workflow": "ai4artsed_AceStep_Instrumental_2511161409.json",
    "note": "Simplified workflow - prompt interception handled by DevServer Stage 2, direct text input to AceStep"
  }
}
