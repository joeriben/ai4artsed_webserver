import{d as te,r as P,b as u,e as R,c as S,o as v,n as U,f as ne,a as s,t as b,_ as K,u as G,w as oe,g as O,h as j,i as W,F as q,j as Q,k as se,T as re,l as H,m as ae,p as le,q as E,s as ce}from"./index-IxyB1cSJ.js";import{u as ie}from"./pipelineExecution-D07hqEeF.js";import"./index-B9ygI19o.js";const J=te("configSelection",()=>{const n=P(new Set),l=P([]),r=P([]),C=P([]),m=P(!1),g=P(new Map),h=P("de"),c=P(!1),d=P(null),a=u(()=>{const t=new Map;return C.value.forEach(([i,y])=>{t.set(i,y),t.set(y,i)}),t}),w=u(()=>n.value.size===0?l.value:l.value.filter(t=>Array.from(n.value).every(i=>t.properties.includes(i)))),I=u(()=>w.value.length),x=u(()=>n.value.size>0&&I.value===0),X=u(()=>x.value?l.value.map(i=>{const y=Array.from(n.value).filter(e=>i.properties.includes(e));return{config:i,matchingProps:y,matchScore:y.length}}).filter(i=>i.matchScore>0).sort((i,y)=>y.matchScore-i.matchScore).slice(0,5):[]);async function M(){c.value=!0,d.value=null;try{const t=await fetch("/pipeline_configs_with_properties");if(!t.ok)throw new Error(`API error: ${t.status} ${t.statusText}`);const i=await t.json();l.value=i.configs;const y=[...new Set(i.configs.flatMap(_=>_.properties))];r.value=y;const e=new Map;i.configs.forEach(_=>{const o=_.properties[0];o&&_.icon&&!e.has(o)&&e.set(o,{symbol:_.icon,label:"",tooltip:""})}),g.value=e,console.log("[ConfigSelection] Symbol map:",Array.from(e.entries())),console.log(`[ConfigSelection] Loaded ${i.configs.length} configs, ${y.length} categories`),C.value=i.property_pairs}catch(t){d.value=t instanceof Error?t.message:"Unknown error loading configs",console.error("[ConfigSelection] Error loading configs:",t)}finally{c.value=!1}}function Y(t){n.value.has(t)?n.value.delete(t):(n.value.clear(),n.value.add(t)),n.value=new Set(n.value)}function B(t){return n.value.has(t)}function N(t){return a.value.get(t)}function f(){n.value.clear(),n.value=new Set}function p(t){n.value=new Set(t)}function k(t){return g.value.get(t)}function $(t){h.value=t,m.value&&M()}return{selectedProperties:u(()=>Array.from(n.value)),availableConfigs:u(()=>l.value),categories:u(()=>r.value),propertyPairs:u(()=>C.value),isLoading:u(()=>c.value),error:u(()=>d.value),symbolsEnabled:u(()=>m.value),currentLanguage:u(()=>h.value),filteredConfigs:w,matchCount:I,hasNoMatch:x,partialMatches:X,loadConfigs:M,toggleProperty:Y,isPropertySelected:B,getOppositeProperty:N,clearAllProperties:f,setProperties:p,getSymbolData:k,setLanguage:$}}),ue=["title","data-property"],ge={class:"property-symbol"},de=R({__name:"PropertyBubble",props:{property:{},color:{},isSelected:{type:Boolean},x:{},y:{},symbolData:{}},emits:["toggle","updatePosition"],setup(n,{emit:l}){const r=n,C=l,m=P(null),g=P(!1),h=P(!1),c=P({x:0,y:0}),d=u(()=>r.symbolData?.symbol||"");u(()=>r.symbolData?.label||r.property);const a=u(()=>r.symbolData?.tooltip||""),w=u(()=>({left:`${r.x}%`,top:`${r.y}%`,"--bubble-color":r.color,"--bubble-shadow":r.isSelected?`0 0 20px ${r.color}`:"none",cursor:g.value?"grabbing":"grab"}));function I(f){!g.value&&!h.value&&(console.log("[PropertyBubble] Click:",r.property),C("toggle",r.property))}function x(f){f.preventDefault(),g.value=!0,h.value=!1,document.addEventListener("mousemove",X),document.addEventListener("mouseup",M)}function X(f){if(!g.value||!m.value)return;h.value=!0;const p=m.value.parentElement;if(!p)return;const k=p.getBoundingClientRect(),$=f.clientX-k.left,t=f.clientY-k.top,i=$/k.width*100,y=t/k.height*100;C("updatePosition",r.property,i,y)}function M(){g.value=!1,document.removeEventListener("mousemove",X),document.removeEventListener("mouseup",M),setTimeout(()=>{h.value=!1},100)}function Y(f){f.preventDefault(),g.value=!0,h.value=!1;const p=f.touches[0];p&&(c.value={x:p.clientX,y:p.clientY},document.addEventListener("touchmove",B,{passive:!1}),document.addEventListener("touchend",N))}function B(f){if(!g.value||!m.value)return;f.preventDefault(),h.value=!0;const p=f.touches[0];if(!p)return;const k=m.value.parentElement;if(!k)return;const $=k.getBoundingClientRect(),t=p.clientX-$.left,i=p.clientY-$.top,y=t/$.width*100,e=i/$.height*100;C("updatePosition",r.property,y,e)}function N(f){if(g.value=!1,document.removeEventListener("touchmove",B),document.removeEventListener("touchend",N),!h.value){const p=f.changedTouches[0];if(p){const k=Math.abs(p.clientX-c.value.x),$=Math.abs(p.clientY-c.value.y),t=10;k<t&&$<t&&C("toggle",r.property)}}setTimeout(()=>{h.value=!1},100)}return(f,p)=>(v(),S("div",{ref_key:"bubbleEl",ref:m,class:ne(["property-bubble",{selected:n.isSelected,dragging:g.value}]),style:U(w.value),title:a.value,onClick:I,onMousedown:x,onTouchstart:Y,"data-property":n.property},[s("span",ge,b(d.value),1)],46,ue))}}),pe=K(de,[["__scopeId","data-v-55f9cf29"]]),fe={class:"property-canvas"},ve={class:"cluster-wrapper"},he=["onClick","onTouchstart"],me={class:"config-content"},ye={class:"text-badge"},be=R({__name:"PropertyCanvas",props:{selectedProperties:{}},emits:["toggleProperty","selectConfig"],setup(n,{emit:l}){const r=n,C=l,m=J(),g=G(),h=H(),c=P(null),d=P(!1),a=u(()=>m.categories),w=u(()=>g.language),I=u(()=>m.availableConfigs),x=u(()=>c.value?I.value.filter(e=>e.properties&&e.properties.includes(c.value)):[]),X={semantics:"#2196F3",aesthetics:"#9C27B0",arts:"#E91E63",heritage:"#4CAF50",freestyle:"#FFC107",technical_imaging:"#607D8B"},M=P({});function Y(){const e={},D=a.value;D.includes("freestyle")&&(e.freestyle={x:50,y:50});const A=D.filter(L=>L!=="freestyle");if(A.length===0){M.value=e;return}const T=2*Math.PI/A.length;A.forEach((L,V)=>{const z=V*T-Math.PI/4,Z=50+Math.cos(z)*35,ee=50+Math.sin(z)*35;e[L]={x:Z,y:ee}}),M.value=e}function B(e){return X[e]??"#888888"}function N(e){return r.selectedProperties.includes(e)}function f(e){console.log("[PropertyCanvas] Toggle:",e),console.log("[PropertyCanvas] Before - Selected:",r.selectedProperties),c.value===e?c.value=null:c.value=e,C("toggleProperty",e),console.log("[PropertyCanvas] After - Selected:",r.selectedProperties)}function p(e){return m.getSymbolData(e)}function k(e){return typeof e.name=="string"?e.name:e.name[w.value]||e.name.en||""}function $(e){return`/config-previews/${e.id}.png`}function t(e,_){const o=M.value[c.value];if(!o)return{left:"50%",top:"50%"};const F=x.value.length,D=2*Math.PI/F,A=_*D-Math.PI/2,T=17,L=o.x+Math.cos(A)*T,V=o.y+Math.sin(A)*T;return{left:`${L}%`,top:`${V}%`}}async function i(e){if(d.value){console.log("[PropertyCanvas] Navigation already in progress, ignoring click");return}d.value=!0,console.log("[PropertyCanvas] Config selected:",e.id);try{C("selectConfig",e.id),await le(),await h.push({name:"pipeline-execution",params:{configId:e.id}}),console.log("[PropertyCanvas] Navigation completed successfully")}catch(_){console.error("[PropertyCanvas] Navigation failed:",_)}finally{setTimeout(()=>{d.value=!1},500)}}function y(e,_,o){const T=_-50,L=o-50;if(Math.sqrt(T*T+L*L)>35){const z=Math.atan2(L,T);_=50+Math.cos(z)*35,o=50+Math.sin(z)*35}M.value={...M.value,[e]:{x:_,y:o}}}return oe(a,()=>{Y()}),O(()=>{Y()}),(e,_)=>(v(),S("div",fe,[s("div",ve,[(v(!0),S(q,null,Q(a.value,o=>(v(),j(pe,{key:o,property:o,color:B(o),"is-selected":N(o),x:M.value[o]?.x??50,y:M.value[o]?.y??50,"symbol-data":p(o),onToggle:f,onUpdatePosition:y},null,8,["property","color","is-selected","x","y","symbol-data"]))),128)),c.value&&x.value.length>0?(v(),j(re,{key:0,name:"config-fade"},{default:se(()=>[(v(!0),S(q,null,Q(x.value,(o,F)=>(v(),S("div",{key:o.id,class:"config-bubble",style:U(t(o,F)),onClick:D=>i(o),onTouchstart:ae(D=>i(o),["prevent"])},[s("div",me,[s("div",{class:"preview-image",style:U({backgroundImage:`url(${$(o)})`})},null,4),s("div",ye,b(k(o)),1)])],44,he))),128))]),_:1})):W("",!0)])]))}}),Pe=K(be,[["__scopeId","data-v-dd8ff78d"]]),Ce={class:"no-match-state"},_e={class:"no-match-content"},Se={class:"no-match-title"},we={class:"no-match-message"},Me={key:0,class:"suggestions"},ke={class:"suggestions-title"},$e={class:"suggestions-subtitle"},Le={class:"suggestions-list"},Ee=["onClick"],xe={class:"suggestion-header"},Te={class:"suggestion-name"},De={class:"suggestion-score"},Ae={class:"suggestion-description"},Ie={class:"suggestion-properties"},Xe={class:"no-match-actions"},Ye=R({__name:"NoMatchState",props:{partialMatches:{},selectedPropertiesCount:{},currentLanguage:{}},emits:["clearSelection","selectConfig"],setup(n,{emit:l}){const r=l,C={chill:"#9b87f5",chaotic:"#9b87f5",narrative:"#60a5fa",algorithmic:"#60a5fa",facts:"#f87171",emotion:"#f87171",historical:"#fb923c",contemporary:"#fb923c",explore:"#4ade80",create:"#4ade80",playful:"#fbbf24",serious:"#fbbf24"};function m(c){return C[c]||"#888"}function g(){r("clearSelection")}function h(c){r("selectConfig",c)}return(c,d)=>(v(),S("div",Ce,[s("div",_e,[d[0]||(d[0]=s("div",{class:"no-match-icon"},"ðŸ˜¿",-1)),s("h2",Se,b(n.currentLanguage==="en"?"sorry, no matches":"sorry, keine Treffer"),1),s("p",we,b(n.currentLanguage==="en"?"Try a different combination?":"Andere Kombination probieren?"),1),n.partialMatches.length>0?(v(),S("div",Me,[s("h3",ke,b(n.currentLanguage==="en"?"Partial matches":"Teilweise Ãœbereinstimmungen"),1),s("p",$e,b(n.currentLanguage==="en"?"These configs match some of your selected properties:":"Diese Konfigurationen entsprechen einigen Ihrer ausgewÃ¤hlten Eigenschaften:"),1),s("div",Le,[(v(!0),S(q,null,Q(n.partialMatches,a=>(v(),S("div",{key:a.config.id,class:"suggestion-item",onClick:w=>h(a.config.id)},[s("div",xe,[s("h4",Te,b(a.config.name[n.currentLanguage]),1),s("span",De,b(a.matchScore)+"/"+b(n.selectedPropertiesCount),1)]),s("p",Ae,b(a.config.short_description[n.currentLanguage]),1),s("div",Ie,[(v(!0),S(q,null,Q(a.matchingProps,w=>(v(),S("span",{key:w,class:"matching-property",style:U({"--tag-color":m(w)})},b(c.$t("properties."+w)),5))),128))])],8,Ee))),128))])])):W("",!0),s("div",Xe,[s("button",{class:"action-button reset",onClick:g},b(n.currentLanguage==="en"?"reset":"zurÃ¼cksetzen"),1)])])]))}}),Be=K(Ye,[["__scopeId","data-v-c87ac8b0"]]),Ne={class:"property-quadrants-view"},Fe={key:0,class:"loading-state"},ze={key:1,class:"error-state"},Ve={key:2,class:"main-layout"},Ue=R({__name:"PropertyQuadrantsView",setup(n){const l=J(),r=G(),C=ie(),m=H(),g=u(()=>r.language);function h(d){console.log("[PropertyQuadrantsView] Toggle:",d),l.toggleProperty(d)}function c(d){console.log("[PropertyQuadrants] Config selected:",d),C.clearAll(),m.push({name:"pipeline-execution",params:{configId:d}})}return O(()=>{l.clearAllProperties(),l.loadConfigs()}),(d,a)=>(v(),S("div",Ne,[E(l).isLoading?(v(),S("div",Fe,[a[2]||(a[2]=s("div",{class:"loading-spinner"},null,-1)),s("p",null,b(g.value==="en"?"Loading configs...":"Lade Konfigurationen..."),1)])):E(l).error?(v(),S("div",ze,[a[3]||(a[3]=s("div",{class:"error-icon"},"âŒ",-1)),s("h2",null,b(g.value==="en"?"Error loading configs":"Fehler beim Laden"),1),s("p",null,b(E(l).error),1),s("button",{class:"retry-button",onClick:a[0]||(a[0]=w=>E(l).loadConfigs())},b(g.value==="en"?"Retry":"Erneut versuchen"),1)])):(v(),S("div",Ve,[a[4]||(a[4]=s("header",{class:"header-controls"},[s("h1",{class:"page-title"}," AI4ArtsEd - AI-Lab ")],-1)),ce(Pe,{"selected-properties":E(l).selectedProperties,onToggleProperty:h,onSelectConfig:c},null,8,["selected-properties"]),E(l).hasNoMatch?(v(),j(Be,{key:0,"partial-matches":E(l).partialMatches,"selected-properties-count":E(l).selectedProperties.length,"current-language":g.value,onClearSelection:a[1]||(a[1]=w=>E(l).clearAllProperties()),onSelectConfig:c},null,8,["partial-matches","selected-properties-count","current-language"])):W("",!0)]))]))}}),Ke=K(Ue,[["__scopeId","data-v-006bde60"]]);export{Ke as default};
