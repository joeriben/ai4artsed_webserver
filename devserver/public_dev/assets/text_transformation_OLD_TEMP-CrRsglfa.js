import{e as Z,r as n,b as h,g as ee,v as te,w as le,c as i,a as l,h as se,i as y,f,A as P,B as S,F as E,j as R,s as j,k as T,C as V,D as ae,p as oe,E as x,n as Y,m as L,t as $,o as a,G as K,_ as ne}from"./index-IxyB1cSJ.js";import{u as ie}from"./pipelineExecution-D07hqEeF.js";import{a as A}from"./index-B9ygI19o.js";import{S as re}from"./SpriteProgressAnimation-evQoJbXX.js";const ue={class:"text-transformation-view"},de={class:"input-context-section"},ce={class:"category-section"},ve={class:"category-bubbles-row"},be=["onClick","aria-pressed","aria-disabled","tabindex","onKeydown"],pe={class:"bubble-emoji-small"},me={key:0,class:"config-section"},ge={class:"config-bubbles-container"},fe={class:"config-bubbles-row"},he=["onClick","aria-pressed","onKeydown"],_e=["src","alt"],we={key:1,class:"bubble-emoji-medium"},ye={class:"bubble-label-medium"},xe={key:2,class:"loading-indicator"},Ce={class:"interception-section"},ke={key:0,class:"preview-loading"},Be=["placeholder","readonly"],Fe={class:"start-button-container"},Ie=["disabled"],Pe={key:0,class:"safety-stamp"},Se={key:0,class:"generation-animation-container"},je={key:1,class:"final-output"},$e=["src"],Me={key:2,class:"output-placeholder"},De=["src"],Ee=Z({__name:"text_transformation_OLD_TEMP",setup(Re){const u=n(""),o=n(""),c=n(null),d=n(null),r=n(""),m=n(!1),_=n(!1),v=n(null),w=n(null),C=n(!1),b=n(0),G=n(null),N=n(null),k=n(null),M=[{id:"image",label:"Bild",emoji:"ðŸ–¼ï¸",color:"#4CAF50"},{id:"video",label:"Video",emoji:"ðŸŽ¬",color:"#9C27B0",disabled:!0},{id:"sound",label:"Sound",emoji:"ðŸ”Š",color:"#FF9800",disabled:!0},{id:"3d",label:"3D",emoji:"ðŸ§Š",color:"#00BCD4",disabled:!0}],D={image:[{id:"sd35_large",label:`Stable
Diffusion`,emoji:"ðŸŽ¨",color:"#2196F3",description:"Klassische Bildgenerierung",logo:"/logos/logo_stable_diffusion.png",lightBg:!1},{id:"gpt_image_1",label:"GPT Image",emoji:"ðŸŒŸ",color:"#FFC107",description:"Moderne KI-Bilder",logo:"/logos/ChatGPT-Logo.png",lightBg:!0},{id:"qwen",label:"Qwen",emoji:"ðŸŒ¸",color:"#9C27B0",description:"Qwen Vision Model",logo:"/logos/Qwen_logo.png",lightBg:!1}],video:[],sound:[],"3d":[]},z=n([{id:"generation",label:"Bild",emoji:"ðŸŽ¨",color:"#2196F3",status:"waiting"}]);h(()=>{const s=[...z.value];if(c.value&&s[1]){const e=M.find(t=>t.id===c.value);e&&(s[1]={...s[1],label:e.label,emoji:e.emoji})}return s});const O=h(()=>c.value?D[c.value]||[]:[]);h(()=>{if(!u.value)return"";const s=100;return u.value.length>s?u.value.substring(0,s)+"...":u.value}),h(()=>{if(!o.value)return"";const s=100;return o.value.length>s?o.value.substring(0,s)+"...":o.value}),h(()=>{if(!r.value)return"";const s=150;return r.value.length>s?r.value.substring(0,s)+"...":r.value});const B=h(()=>u.value&&d.value&&r.value&&!m.value),Q=te(),p=ie();ee(async()=>{const s=Q.params.configId;if(s){console.log("[Youth Flow] Received configId from Phase1:",s);try{await p.setConfig(s),console.log("[Youth Flow] Config loaded:",p.selectedConfig?.id),await p.loadMetaPromptForLanguage("de"),console.log("[Youth Flow] Meta-prompt loaded:",p.metaPrompt?.substring(0,50)),o.value=p.metaPrompt||"";let e=null;for(const[t,g]of Object.entries(D))if(g.some(X=>X.id===s)){e=t;break}e?(console.log("[Youth Flow] Auto-selecting category:",e,"and config:",s),c.value=e,d.value=s):console.warn("[Youth Flow] ConfigId not found in any category:",s)}catch(e){console.error("[Youth Flow] Initialization error:",e)}}});function F(s){c.value=s,d.value=null,r.value=""}async function I(s){m.value||(d.value=s,await U())}async function U(){m.value=!0;try{const s=await A.post("/api/schema/pipeline/stage2",{schema:p.selectedConfig?.id||"overdrive",input_text:u.value,context_prompt:o.value||void 0,user_language:"de",execution_mode:"eco",safety_level:"youth",output_config:d.value});s.data.success?(r.value=s.data.stage2_result||"",console.log("[Youth Flow] Interception complete (DE):",r.value.substring(0,60))):alert(`Fehler: ${s.data.error}`)}catch(s){console.error("[Youth Flow] Interception error:",s),alert(`Fehler: ${s.message}`)}finally{m.value=!1}}async function W(){_.value=!0,await oe(),k.value&&k.value.scrollIntoView({behavior:"smooth",block:"start"}),await q()}async function q(){v.value="",C.value=!1,b.value=0,await new Promise(e=>setTimeout(e,300)),C.value=!0;const s=setInterval(()=>{b.value<85&&(b.value+=Math.random()*15,b.value>85&&(b.value=85))},500);try{const e=await A.post("/api/schema/pipeline/execute",{schema:p.selectedConfig?.id||"overdrive",input_text:u.value,interception_result:r.value,context_prompt:o.value||void 0,user_language:"de",execution_mode:"eco",safety_level:"youth",output_config:d.value});if(clearInterval(s),e.data.status==="success"){b.value=100;const t=e.data.media_output?.run_id||e.data.run_id;t?v.value=`/api/media/image/${t}`:e.data.outputs&&e.data.outputs.length>0&&(v.value=`http://localhost:17802${e.data.outputs[0]}`)}else alert(`Generation fehlgeschlagen: ${e.data.error}`),b.value=0}catch(e){clearInterval(s),console.error("Pipeline error:",e),alert(`Fehler: ${e.message}`),b.value=0}finally{_.value=!1}}function H(s){w.value=s}function J(){p.updateMetaPrompt(o.value),console.log("[Youth Flow] Context prompt edited:",o.value.substring(0,50)+"...")}return le(()=>p.metaPrompt,s=>{s!==o.value&&(o.value=s||"",console.log("[Youth Flow] Meta-prompt synced from store"))}),(s,e)=>(a(),i("div",ue,[l("div",{class:"phase-2a",ref_key:"mainContainerRef",ref:G},[l("section",de,[l("div",{class:f(["input-bubble bubble-card",{filled:u.value}])},[e[7]||(e[7]=l("div",{class:"bubble-header"},[l("span",{class:"bubble-icon"},"ðŸ’¡"),l("span",{class:"bubble-label"},"Deine Idee: Worum soll es gehen?")],-1)),P(l("textarea",{"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),placeholder:"Ein Fest in meiner StraÃŸe: ...",class:"bubble-textarea",rows:"3"},null,512),[[S,u.value]])],2),l("div",{class:f(["context-bubble bubble-card",{filled:o.value,required:!o.value}])},[e[8]||(e[8]=l("div",{class:"bubble-header"},[l("span",{class:"bubble-icon"},"ðŸ“‹"),l("span",{class:"bubble-label"},"Bestimme Regeln, Material, Besonderheiten")],-1)),P(l("textarea",{"onUpdate:modelValue":e[1]||(e[1]=t=>o.value=t),onInput:J,placeholder:"Beschreibe alles so, wie es die VÃ¶gel auf den BÃ¤umen wahrnehmen!",class:"bubble-textarea",rows:"3"},null,544),[[S,o.value]])],2)]),l("section",ce,[e[9]||(e[9]=l("h2",{class:"section-title"},"WÃ¤hle ein Medium aus",-1)),l("div",ve,[(a(),i(E,null,R(M,t=>l("div",{key:t.id,class:f(["category-bubble",{selected:c.value===t.id,disabled:t.disabled}]),style:Y({"--bubble-color":t.color}),onClick:g=>!t.disabled&&F(t.id),role:"button","aria-pressed":c.value===t.id,"aria-disabled":t.disabled,tabindex:t.disabled?-1:0,onKeydown:[x(g=>!t.disabled&&F(t.id),["enter"]),x(L(g=>!t.disabled&&F(t.id),["prevent"]),["space"])]},[l("div",pe,$(t.emoji),1)],46,be)),64))])]),c.value?(a(),i("section",me,[e[11]||(e[11]=l("h2",{class:"section-title"},"WÃ¤hle ein KI-Modell aus!",-1)),l("div",ge,[l("div",fe,[(a(!0),i(E,null,R(O.value,t=>(a(),i("div",{key:t.id,class:f(["config-bubble",{selected:d.value===t.id,loading:t.id===d.value&&m.value,"light-bg":t.lightBg}]),style:Y({"--bubble-color":t.color}),onClick:g=>I(t.id),role:"button","aria-pressed":d.value===t.id,tabindex:"0",onKeydown:[x(g=>I(t.id),["enter"]),x(L(g=>I(t.id),["prevent"]),["space"])]},[t.logo?(a(),i("img",{key:0,src:t.logo,alt:t.label,class:"bubble-logo"},null,8,_e)):(a(),i("div",we,$(t.emoji),1)),l("div",ye,$(t.label),1),t.id===d.value&&m.value?(a(),i("div",xe,[...e[10]||(e[10]=[l("div",{class:"spinner"},null,-1)])])):y("",!0)],46,he))),128))])])])):y("",!0),l("section",Ce,[l("div",{class:f(["interception-preview bubble-card",{empty:!r.value,loading:m.value}])},[e[13]||(e[13]=l("div",{class:"bubble-header"},[l("span",{class:"bubble-icon"},"â†’"),l("span",{class:"bubble-label"},"Idee + Regeln = Prompt")],-1)),m.value?(a(),i("div",ke,[...e[12]||(e[12]=[l("div",{class:"spinner-large"},null,-1),l("p",{class:"loading-text"},"Erstelle Prompt...",-1)])])):P((a(),i("textarea",{key:1,"onUpdate:modelValue":e[2]||(e[2]=t=>r.value=t),placeholder:r.value?"":"Du kannst den Prompt hinterher noch verÃ¤ndern.",class:"bubble-textarea",rows:"5",readonly:!r.value},null,8,Be)),[[S,r.value]])],2)]),l("div",Fe,[l("button",{class:f(["start-button",{disabled:!B.value}]),disabled:!B.value,onClick:e[3]||(e[3]=t=>B.value&&W()),ref_key:"startButtonRef",ref:N},[...e[14]||(e[14]=[l("span",{class:"button-arrows button-arrows-left"},">>>",-1),l("span",{class:"button-text"},"Start",-1),l("span",{class:"button-arrows button-arrows-right"},">>>",-1)])],10,Ie),j(V,{name:"fade"},{default:T(()=>[C.value?(a(),i("div",Pe,[...e[15]||(e[15]=[l("div",{class:"stamp-inner"},[l("div",{class:"stamp-icon"},"âœ“"),l("div",{class:"stamp-text"},[K("Safety"),l("br"),K("Approved")])],-1)])])):y("",!0)]),_:1})]),l("section",{class:"pipeline-section",ref_key:"pipelineSectionRef",ref:k},[l("div",{class:f(["output-frame",{empty:!_.value&&!v.value,generating:_.value&&!v.value}])},[_.value&&!v.value?(a(),i("div",Se,[j(re,{progress:b.value},null,8,["progress"])])):v.value?(a(),i("div",je,[l("img",{src:v.value,alt:"Generiertes Bild",class:"output-image",onClick:e[4]||(e[4]=t=>H(v.value))},null,8,$e)])):(a(),i("div",Me,[...e[16]||(e[16]=[l("div",{class:"placeholder-icon"},"ðŸ–¼ï¸",-1),l("p",{class:"placeholder-text"},"Dein Bild erscheint hier",-1)])]))],2)],512)],512),(a(),se(ae,{to:"body"},[j(V,{name:"modal-fade"},{default:T(()=>[w.value?(a(),i("div",{key:0,class:"fullscreen-modal",onClick:e[6]||(e[6]=t=>w.value=null)},[l("img",{src:w.value,alt:"Dein Bild",class:"fullscreen-image"},null,8,De),l("button",{class:"close-fullscreen",onClick:e[5]||(e[5]=t=>w.value=null)},"Ã—")])):y("",!0)]),_:1})]))]))}}),Ke=ne(Ee,[["__scopeId","data-v-f3552c10"]]);export{Ke as default};
