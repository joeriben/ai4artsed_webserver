import{e as W,r as p,b as g,c as o,a as t,h as F,i as w,A as x,B as N,H as B,F as b,j as C,f as S,t as r,s as L,k as U,C as V,D as z,o as a,_ as I}from"./index-IxyB1cSJ.js";import{a as h}from"./index-B9ygI19o.js";const R={class:"direct-view"},J={class:"page-header"},M={class:"main-container"},A={class:"input-section"},Z={class:"section-card"},H={class:"section-card"},K=["value"],q=["disabled"],G={class:"button-text"},P={key:0,class:"output-section"},Q={class:"section-card"},X={key:0,class:"loading-container"},Y={key:1,class:"outputs-container"},ee={key:0,class:"output-image-wrapper"},te=["src","alt","onClick"],se={class:"output-caption"},ne={key:1,class:"output-text-wrapper"},ae={class:"text-header"},oe={class:"text-filename"},le={class:"output-text"},re={key:2,class:"output-json-wrapper"},ie={class:"json-header"},ce={class:"json-filename"},ue={class:"output-json"},de={key:3,class:"output-unknown-wrapper"},pe={class:"unknown-type"},fe={class:"unknown-filename"},ve=["src"],_e=W({__name:"direct",setup(ye){const f=p(""),v=p(""),c=p(!1),_=p([]),u=p(null),$=[{id:"surrealization_legacy",label:"Surrealization (Legacy)"}],y=g(()=>f.value.trim().length>0&&v.value&&!c.value),k=g(()=>_.value.length>0);async function j(){if(y.value){c.value=!0,_.value=[];try{const n=await h.post("/api/schema/pipeline/execute",{schema:"direct_workflow",input_text:f.value,safety_level:"open",output_config:v.value,user_language:"de"});if(n.data.status==="success"){const e=n.data.run_id;e?await D(e):(console.error("[Direct] No run_id in response"),alert("Fehler: Keine run_id erhalten"))}else alert(`Fehler: ${n.data.error}`)}catch(n){console.error("[Direct] Execution error:",n);const e=n.response?.data?.error||n.message;alert(`Fehler: ${e}`)}finally{c.value=!1}}}async function D(n){try{const s=(await h.get(`/api/pipeline/${n}/entities`)).data.entities||[];console.log("[Direct] Entities:",s);for(const l of s){const i=await O(n,l);i&&_.value.push(i)}}catch(e){console.error("[Direct] Error fetching outputs:",e)}}async function O(n,e){try{const s=e.type,l=e.filename;if(["input","translation","safety","safety_pre_output"].includes(s))return null;const i=await h.get(`/api/pipeline/${n}/entity/${s}`,{responseType:"blob"}),m=i.headers["content-type"];if(m.startsWith("image/")){const d=URL.createObjectURL(i.data);return{type:"image",filename:l,url:d}}else if(m.includes("application/json")){const d=await i.data.text();return{type:"json",filename:l,content:d}}else if(m.includes("text/")){const d=await i.data.text();return{type:"text",filename:l,content:d}}else return{type:"unknown",filename:l}}catch(s){return console.error("[Direct] Error processing entity:",s),null}}function E(n){try{const e=JSON.parse(n);return JSON.stringify(e,null,2)}catch{return n}}function T(n){u.value=n}return(n,e)=>(a(),o("div",R,[t("header",J,[t("button",{class:"return-button",onClick:e[0]||(e[0]=s=>n.$router.push("/")),title:"ZurÃ¼ck zur Startseite"}," â† ZurÃ¼ck "),e[5]||(e[5]=t("h1",{class:"page-title"},"Direct Workflow Execution",-1))]),t("div",M,[t("section",A,[t("div",Z,[e[6]||(e[6]=t("div",{class:"card-header"},[t("span",{class:"card-icon"},"ðŸ’¡"),t("span",{class:"card-label"},"Dein Input")],-1)),x(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=s=>f.value=s),placeholder:"Beschreibe deine Idee...",class:"input-textarea",rows:"6"},null,512),[[N,f.value]])]),t("div",H,[e[8]||(e[8]=t("div",{class:"card-header"},[t("span",{class:"card-icon"},"âš™ï¸"),t("span",{class:"card-label"},"Workflow auswÃ¤hlen")],-1)),x(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>v.value=s),class:"config-select"},[e[7]||(e[7]=t("option",{value:"",disabled:""},"Workflow auswÃ¤hlen...",-1)),(a(),o(b,null,C($,s=>t("option",{key:s.id,value:s.id},r(s.label),9,K)),64))],512),[[B,v.value]])]),t("button",{class:S(["execute-button",{disabled:!y.value}]),disabled:!y.value,onClick:j},[t("span",G,r(c.value?"LÃ¤uft...":"Workflow starten"),1)],10,q)]),k.value||c.value?(a(),o("section",P,[t("div",Q,[e[12]||(e[12]=t("div",{class:"card-header"},[t("span",{class:"card-icon"},"ðŸ“¦"),t("span",{class:"card-label"},"Workflow Outputs")],-1)),c.value&&!k.value?(a(),o("div",X,[...e[9]||(e[9]=[t("div",{class:"spinner"},null,-1),t("p",{class:"loading-text"},"Workflow wird ausgefÃ¼hrt...",-1)])])):(a(),o("div",Y,[(a(!0),o(b,null,C(_.value,(s,l)=>(a(),o("div",{key:l,class:"output-item"},[s.type==="image"?(a(),o("div",ee,[t("img",{src:s.url,alt:`Output ${l+1}`,class:"output-image",onClick:i=>s.url&&T(s.url)},null,8,te),t("p",se,r(s.filename),1)])):s.type==="text"?(a(),o("div",ne,[t("div",ae,[e[10]||(e[10]=t("span",{class:"text-icon"},"ðŸ“„",-1)),t("span",oe,r(s.filename),1)]),t("pre",le,r(s.content),1)])):s.type==="json"?(a(),o("div",re,[t("div",ie,[e[11]||(e[11]=t("span",{class:"json-icon"},"ðŸ“‹",-1)),t("span",ce,r(s.filename),1)]),t("pre",ue,r(s.content?E(s.content):""),1)])):(a(),o("div",de,[t("p",pe,"Unbekannter Output-Typ: "+r(s.type),1),t("p",fe,r(s.filename),1)]))]))),128))]))])])):w("",!0)]),(a(),F(z,{to:"body"},[L(V,{name:"modal-fade"},{default:U(()=>[u.value?(a(),o("div",{key:0,class:"fullscreen-modal",onClick:e[4]||(e[4]=s=>u.value=null)},[t("img",{src:u.value,alt:"Fullscreen",class:"fullscreen-image"},null,8,ve),t("button",{class:"close-fullscreen",onClick:e[3]||(e[3]=s=>u.value=null)},"Ã—")])):w("",!0)]),_:1})]))]))}}),ke=I(_e,[["__scopeId","data-v-4afb8667"]]);export{ke as default};
