import{e as me,r as o,b as k,g as ge,v as fe,w as A,c as n,a as l,h as he,i as C,f as h,A as T,B as M,F as q,j as J,s as E,k as X,C as Z,D as _e,p as B,E as S,n as ee,m as te,t as O,G as ae,o as s,_ as we}from"./index-IxyB1cSJ.js";import{u as ye}from"./pipelineExecution-D07hqEeF.js";import{a as G}from"./index-B9ygI19o.js";import{S as xe}from"./SpriteProgressAnimation-evQoJbXX.js";const ke={class:"text-transformation-view"},Ce={class:"page-header"},Be={class:"input-context-section"},Pe={class:"start-button-container"},Ie=["disabled"],ze={class:"interception-section"},Fe={key:0,class:"preview-loading"},Te={key:0,class:"section-title"},Me={class:"category-bubbles-row"},Se=["onClick","aria-pressed","aria-disabled","tabindex","onKeydown"],je={class:"bubble-emoji-small"},$e={class:"config-section"},Re={key:0,class:"section-title"},De={class:"config-bubbles-container"},Ke={class:"config-bubbles-row"},Ve=["onClick","aria-pressed","aria-disabled","tabindex","onKeydown"],Ae=["src","alt"],Ee={key:1,class:"bubble-emoji-medium"},Oe={class:"bubble-label-medium"},Ge={key:2,class:"loading-indicator"},Le={key:0,class:"optimization-section"},Ye={key:0,class:"preview-loading"},Ne=["placeholder","readonly"],Ue={class:"start-button-container"},He=["disabled"],We={key:0,class:"safety-stamp"},Qe={key:0,class:"generation-animation-container"},qe={key:1,class:"final-output"},Je=["src"],Xe=["src"],Ze=["src"],et={key:3,class:"model-container"},tt=["href"],at={key:4,class:"unknown-media"},lt=["href"],ot=["src"],st=me({__name:"text_transformation",setup(nt){const c=o(""),r=o(""),m=o(null),b=o(null),i=o(""),I=o(!1),u=o(""),_=o(!1),j=o(!1),L=o(""),w=o(null),d=o("initial"),P=o(!1),v=o(null),y=o("image"),z=o(null),$=o(!1),g=o(0),le=o(null),oe=o(null),se=o(null),Y=o(null),N=o(null),R=o(null),U=[{id:"image",label:"Bild",emoji:"ðŸ–¼ï¸",color:"#4CAF50"},{id:"video",label:"Video",emoji:"ðŸŽ¬",color:"#9C27B0"},{id:"sound",label:"Sound",emoji:"ðŸ”Š",color:"#FF9800"},{id:"3d",label:"3D",emoji:"ðŸ§Š",color:"#00BCD4",disabled:!0}],H={image:[{id:"sd35_large",label:`Stable
Diffusion`,emoji:"ðŸŽ¨",color:"#2196F3",description:"Klassische Bildgenerierung",logo:"/logos/logo_stable_diffusion.png",lightBg:!1},{id:"gpt_image_1",label:"GPT Image",emoji:"ðŸŒŸ",color:"#FFC107",description:"Moderne KI-Bilder",logo:"/logos/ChatGPT-Logo.png",lightBg:!0},{id:"gemini_3_pro_image",label:`Gemini 3
Pro`,emoji:"ðŸ”·",color:"#4285F4",description:"Google Gemini Bildgenerierung",lightBg:!1},{id:"qwen",label:"Qwen",emoji:"ðŸŒ¸",color:"#9C27B0",description:"Qwen Vision Model",logo:"/logos/Qwen_logo.png",lightBg:!1}],video:[{id:"ltx_video",label:`LTX
Video`,emoji:"âš¡",color:"#9C27B0",description:"Schnelle lokale Videogenerierung",lightBg:!1},{id:"wan22_video",label:`Wan 2.2
Video`,emoji:"ðŸŽ¬",color:"#E91E63",description:"Hochwertige 720p Videogenerierung mit Wan 2.2 (5B)",lightBg:!1}],sound:[{id:"acenet_t2instrumental",label:`ACE
Instrumental`,emoji:"ðŸŽµ",color:"#FF5722",description:"KI-Musikgenerierung fÃ¼r InstrumentalstÃ¼cke",lightBg:!1},{id:"stableaudio_open",label:`Stable
Audio`,emoji:"ðŸ”Š",color:"#00BCD4",description:"Open-Source Audio-Generierung (max 47s)",lightBg:!1}],"3d":[]},ne=o([{id:"generation",label:"Bild",emoji:"ðŸŽ¨",color:"#2196F3",status:"waiting"}]);k(()=>{const t=[...ne.value];if(m.value&&t[1]){const e=U.find(a=>a.id===m.value);e&&(t[1]={...t[1],label:e.label,emoji:e.emoji})}return t});const ie=k(()=>m.value?H[m.value]||[]:[]);k(()=>{if(!c.value)return"";const t=100;return c.value.length>t?c.value.substring(0,t)+"...":c.value}),k(()=>{if(!r.value)return"";const t=100;return r.value.length>t?r.value.substring(0,t)+"...":r.value}),k(()=>{if(!i.value)return"";const t=150;return i.value.length>t?i.value.substring(0,t)+"...":i.value}),k(()=>d.value==="initial"?c.value&&m.value&&!I.value:d.value==="optimization_done"?i.value&&u.value&&b.value&&!P.value:!1);const x=k(()=>i.value.trim().length>0),re=fe(),f=ye();ge(async()=>{const t=re.params.configId;if(t){console.log("[Youth Flow] Received configId from Phase1:",t);try{await f.setConfig(t),console.log("[Youth Flow] Config loaded:",f.selectedConfig?.id),await f.loadMetaPromptForLanguage("de"),console.log("[Youth Flow] Meta-prompt loaded:",f.metaPrompt?.substring(0,50)),r.value=f.metaPrompt||"";let e=null;for(const[a,p]of Object.entries(H))if(p.some(F=>F.id===t)){e=a;break}e?(console.log("[Youth Flow] Auto-selecting category:",e,"and config:",t),m.value=e,b.value=t):console.warn("[Youth Flow] ConfigId not found in any category:",t)}catch(e){console.error("[Youth Flow] Initialization error:",e)}}});function W(t,e="start"){if(!t)return;const a=t.getBoundingClientRect();(e==="start"?a.top:a.bottom-window.innerHeight)>0&&t.scrollIntoView({behavior:"smooth",block:e})}function D(){window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})}async function K(t){m.value=t,b.value=null,await B(),W(R.value,"start")}async function V(t){if(!(!x.value||_.value)){if(b.value=t,!i.value||i.value.trim()===""){u.value=c.value,j.value=!1,d.value="optimization_done",console.log("[Direct Mode] Skipping optimization, using input text directly");return}console.log("[SelectConfig] Triggering optimization for:",t),await de()}}async function ue(){I.value=!0;try{const t=await G.post("/api/schema/pipeline/stage2",{schema:f.selectedConfig?.id||"overdrive",input_text:c.value,context_prompt:r.value||void 0,user_language:"de",safety_level:"youth"});t.data.success?(i.value=t.data.interception_result||t.data.stage2_result||"",d.value="interception_done",console.log("[2-Phase] Interception complete:",i.value.substring(0,60)),await B(),W(R.value,"end")):alert(`Fehler: ${t.data.error}`)}catch(t){console.error("[2-Phase] Interception error:",t);const e=t.response?.data?.error||t.message;alert(`Fehler: ${e}`)}finally{I.value=!1}}async function de(){_.value=!0;try{const t=await G.post("/api/schema/pipeline/optimize",{input_text:i.value,output_config:b.value});t.data.success?(u.value=t.data.optimized_prompt||"",j.value=t.data.optimization_applied||!1,d.value="optimization_done",console.log("[Optimize] Complete:",u.value.substring(0,60),"| Applied:",j.value)):alert(`Fehler: ${t.data.error}`)}catch(t){console.error("[Optimize] Error:",t);const e=t.response?.data?.error||t.message;alert(`Fehler: ${e}`)}finally{_.value=!1}}async function ce(){if(!b.value){alert("Bitte wÃ¤hle ein KI-Modell aus");return}P.value=!0,await B(),setTimeout(()=>D(),150),await ve()}async function ve(){v.value="",$.value=!1,g.value=0;const t=u.value||i.value||c.value;t===L.value?(w.value=Math.floor(Math.random()*2147483647),console.log("[Phase 4] Prompt unchanged â†’ New random seed:",w.value)):(w.value===null?(w.value=123456789,console.log("[Phase 4] First run â†’ Default seed:",w.value)):console.log("[Phase 4] Prompt changed â†’ Keeping seed:",w.value),L.value=t),await new Promise(a=>setTimeout(a,300)),$.value=!0;const e=setInterval(()=>{g.value<85&&(g.value+=Math.random()*15,g.value>85&&(g.value=85))},500);try{const a=await G.post("/api/schema/pipeline/execute",{schema:f.selectedConfig?.id||"overdrive",input_text:t,interception_result:u.value,context_prompt:r.value||void 0,user_language:"de",safety_level:"youth",output_config:b.value,seed:w.value});if(clearInterval(e),a.data.status==="success"){g.value=100;const p=a.data.media_output?.run_id||a.data.run_id,F=a.data.media_output?.media_type||"image";p?(y.value=F,v.value=`/api/media/${F}/${p}`,d.value="generation_done",await B(),setTimeout(()=>D(),150)):a.data.outputs&&a.data.outputs.length>0&&(y.value="image",v.value=`http://localhost:17802${a.data.outputs[0]}`,d.value="generation_done",await B(),setTimeout(()=>D(),150))}else alert(`Generation fehlgeschlagen: ${a.data.error}`),g.value=0}catch(a){clearInterval(e),console.error("Pipeline error:",a);const p=a.response?.data?.error||a.message;alert(`Fehler: ${p}`),g.value=0}finally{P.value=!1}}function pe(t){z.value=t}function be(){f.updateMetaPrompt(r.value),console.log("[Youth Flow] Context prompt edited:",r.value.substring(0,50)+"...")}function Q(t){t&&(t.style.height="auto",t.style.height=t.scrollHeight+4+"px")}return A(()=>f.metaPrompt,t=>{t!==r.value&&(r.value=t||"",console.log("[Youth Flow] Meta-prompt synced from store"))}),A(i,async t=>{await B(),Q(Y.value),t.trim().length>0&&d.value==="initial"&&(d.value="interception_done")}),A(u,async()=>{await B(),Q(N.value)}),(t,e)=>(s(),n("div",ke,[l("header",Ce,[l("button",{class:"return-button",onClick:e[0]||(e[0]=a=>t.$router.push("/")),title:"ZurÃ¼ck zu Phase 1"}," â† Phase 1 "),e[10]||(e[10]=l("h1",{class:"page-title"},"AI4ArtsEd - AI-Lab",-1))]),l("div",{class:"phase-2a",ref_key:"mainContainerRef",ref:le},[l("section",Be,[l("div",{class:h(["input-bubble bubble-card",{filled:c.value}])},[e[11]||(e[11]=l("div",{class:"bubble-header"},[l("span",{class:"bubble-icon"},"ðŸ’¡"),l("span",{class:"bubble-label"},"Deine Idee: Worum soll es gehen?")],-1)),T(l("textarea",{"onUpdate:modelValue":e[1]||(e[1]=a=>c.value=a),placeholder:"Ein Fest in meiner StraÃŸe: ...",class:"bubble-textarea",rows:"6"},null,512),[[M,c.value]])],2),l("div",{class:h(["context-bubble bubble-card",{filled:r.value,required:!r.value}])},[e[12]||(e[12]=l("div",{class:"bubble-header"},[l("span",{class:"bubble-icon"},"ðŸ“‹"),l("span",{class:"bubble-label"},"Bestimme Regeln, Material, Besonderheiten")],-1)),T(l("textarea",{"onUpdate:modelValue":e[2]||(e[2]=a=>r.value=a),onInput:be,placeholder:"Beschreibe alles so, wie es die VÃ¶gel auf den BÃ¤umen wahrnehmen!",class:"bubble-textarea",rows:"6"},null,544),[[M,r.value]])],2)]),l("div",Pe,[l("button",{class:h(["start-button",{disabled:!c.value}]),disabled:!c.value,onClick:e[3]||(e[3]=a=>ue())},[...e[13]||(e[13]=[l("span",{class:"button-arrows button-arrows-left"},">>>",-1),l("span",{class:"button-text"},"Start",-1),l("span",{class:"button-arrows button-arrows-right"},">>>",-1)])],10,Ie)]),l("section",ze,[l("div",{class:h(["interception-preview bubble-card",{empty:!i.value,loading:I.value}])},[e[15]||(e[15]=l("div",{class:"bubble-header"},[l("span",{class:"bubble-icon"},"â†’"),l("span",{class:"bubble-label"},"Idee + Regeln = Prompt")],-1)),I.value?(s(),n("div",Fe,[...e[14]||(e[14]=[l("div",{class:"spinner-large"},null,-1),l("p",{class:"loading-text"},"Die KI kombiniert jetzt deine Idee mit den Regeln und erstellt einen kreativen Prompt, der zu deinem gewÃ¤hlten Kunststil passt.",-1)])])):T((s(),n("textarea",{key:1,ref_key:"interceptionTextareaRef",ref:Y,"onUpdate:modelValue":e[4]||(e[4]=a=>i.value=a),placeholder:"Prompt erscheint nach Start-Klick (oder eigenen Text eingeben)",class:"bubble-textarea auto-resize-textarea",rows:"5"},null,512)),[[M,i.value]])],2)]),l("section",{class:"category-section",ref_key:"categorySectionRef",ref:R},[d.value!=="initial"?(s(),n("h2",Te,"WÃ¤hle ein Medium aus")):C("",!0),l("div",Me,[(s(),n(q,null,J(U,a=>l("div",{key:a.id,class:h(["category-bubble",{selected:m.value===a.id,disabled:a.disabled}]),style:ee({"--bubble-color":a.color}),onClick:p=>!a.disabled&&K(a.id),role:"button","aria-pressed":m.value===a.id,"aria-disabled":a.disabled,tabindex:a.disabled?-1:0,onKeydown:[S(p=>!a.disabled&&K(a.id),["enter"]),S(te(p=>!a.disabled&&K(a.id),["prevent"]),["space"])]},[l("div",je,O(a.emoji),1)],46,Se)),64))])],512),l("section",$e,[m.value?(s(),n("h2",Re,"wÃ¤hle ein KI-Modell aus")):C("",!0),l("div",De,[l("div",Ke,[(s(!0),n(q,null,J(ie.value,a=>(s(),n("div",{key:a.id,class:h(["config-bubble",{selected:b.value===a.id,loading:a.id===b.value&&_.value,"light-bg":a.lightBg,disabled:!x.value}]),style:ee({"--bubble-color":a.color}),onClick:p=>x.value&&V(a.id),role:"button","aria-pressed":b.value===a.id,"aria-disabled":!x.value,tabindex:x.value?0:-1,onKeydown:[S(p=>x.value&&V(a.id),["enter"]),S(te(p=>x.value&&V(a.id),["prevent"]),["space"])]},[a.logo?(s(),n("img",{key:0,src:a.logo,alt:a.label,class:"bubble-logo"},null,8,Ae)):(s(),n("div",Ee,O(a.emoji),1)),l("div",Oe,O(a.label),1),a.id===b.value&&_.value?(s(),n("div",Ge,[...e[16]||(e[16]=[l("div",{class:"spinner"},null,-1)])])):C("",!0)],46,Ve))),128))])])]),b.value?(s(),n("section",Le,[l("div",{class:h(["optimization-preview bubble-card",{empty:!u.value,loading:_.value}])},[e[18]||(e[18]=l("div",{class:"bubble-header"},[l("span",{class:"bubble-icon"},"âœ¨"),l("span",{class:"bubble-label"},"Modell-Optimierter Prompt")],-1)),_.value?(s(),n("div",Ye,[...e[17]||(e[17]=[l("div",{class:"spinner-large"},null,-1),l("p",{class:"loading-text"},"Der Prompt wird jetzt fÃ¼r das gewÃ¤hlte KI-Modell angepasst. Jedes Modell versteht Beschreibungen etwas anders â€“ die KI optimiert den Text fÃ¼r die beste Ausgabe.",-1)])])):T((s(),n("textarea",{key:1,ref_key:"optimizationTextareaRef",ref:N,"onUpdate:modelValue":e[5]||(e[5]=a=>u.value=a),placeholder:u.value?"":"Der optimierte Prompt erscheint nach Modellauswahl.",class:"bubble-textarea auto-resize-textarea",rows:"5",readonly:!u.value},null,8,Ne)),[[M,u.value]])],2)])):C("",!0),l("div",Ue,[l("button",{class:h(["start-button",{disabled:d.value!=="optimization_done"&&d.value!=="generation_done"||!u.value}]),disabled:d.value!=="optimization_done"&&d.value!=="generation_done"||!u.value,onClick:e[6]||(e[6]=a=>ce()),ref_key:"startButtonRef",ref:oe},[...e[19]||(e[19]=[l("span",{class:"button-arrows button-arrows-left"},">>>",-1),l("span",{class:"button-text"},"Start",-1),l("span",{class:"button-arrows button-arrows-right"},">>>",-1)])],10,He),E(Z,{name:"fade"},{default:X(()=>[$.value?(s(),n("div",We,[...e[20]||(e[20]=[l("div",{class:"stamp-inner"},[l("div",{class:"stamp-icon"},"âœ“"),l("div",{class:"stamp-text"},[ae("Safety"),l("br"),ae("Approved")])],-1)])])):C("",!0)]),_:1})]),l("section",{class:"pipeline-section",ref_key:"pipelineSectionRef",ref:se},[l("div",{class:h(["output-frame",{empty:!P.value&&!v.value,generating:P.value&&!v.value}])},[P.value&&!v.value?(s(),n("div",Qe,[E(xe,{progress:g.value},null,8,["progress"])])):v.value?(s(),n("div",qe,[y.value==="image"?(s(),n("img",{key:0,src:v.value,alt:"Generiertes Bild",class:"output-image",onClick:e[7]||(e[7]=a=>pe(v.value))},null,8,Je)):y.value==="video"?(s(),n("video",{key:1,src:v.value,controls:"",class:"output-video"},null,8,Xe)):y.value==="audio"||y.value==="music"?(s(),n("audio",{key:2,src:v.value,controls:"",class:"output-audio"},null,8,Ze)):y.value==="3d"?(s(),n("div",et,[e[21]||(e[21]=l("div",{class:"model-icon"},"ðŸŽ¨",-1)),l("a",{href:v.value,download:"",class:"download-button"},"3D-Modell herunterladen",8,tt),e[22]||(e[22]=l("p",{class:"model-hint"},"Ã–ffne mit Blender oder anderer 3D-Software",-1))])):(s(),n("div",at,[l("a",{href:v.value,download:"",class:"download-button"},"Datei herunterladen",8,lt)]))])):C("",!0)],2)],512)],512),(s(),he(_e,{to:"body"},[E(Z,{name:"modal-fade"},{default:X(()=>[z.value?(s(),n("div",{key:0,class:"fullscreen-modal",onClick:e[9]||(e[9]=a=>z.value=null)},[l("img",{src:z.value,alt:"Dein Bild",class:"fullscreen-image"},null,8,ot),l("button",{class:"close-fullscreen",onClick:e[8]||(e[8]=a=>z.value=null)},"Ã—")])):C("",!0)]),_:1})]))]))}}),ct=we(st,[["__scopeId","data-v-727b9082"]]);export{ct as default};
