import{e as be,r as o,b as k,g as me,v as ge,w as E,c as n,a as l,h as fe,i as C,f as h,A as T,B as j,F as q,j as J,s as G,k as X,C as Z,D as he,p as B,E as $,n as ee,m as te,t as L,G as ae,o as s,_ as _e}from"./index-CxAVWkdj.js";import{u as we}from"./pipelineExecution-0tC6C8XI.js";import{a as O}from"./index-B9ygI19o.js";import{S as ye}from"./SpriteProgressAnimation-C6IxaYC9.js";const xe={class:"text-transformation-view"},ke={class:"page-header"},Ce={class:"input-context-section"},Be={class:"start-button-container"},Pe=["disabled"],Ie={class:"interception-section"},ze={key:0,class:"preview-loading"},Fe={key:0,class:"section-title"},Me={class:"category-bubbles-row"},Se=["onClick","aria-pressed","aria-disabled","tabindex","onKeydown"],Te={class:"bubble-emoji-small"},je={class:"config-section"},$e={key:0,class:"section-title"},Re={class:"config-bubbles-container"},De={class:"config-bubbles-row"},Ke=["onClick","aria-pressed","aria-disabled","tabindex","onKeydown"],Ve=["src","alt"],Ae={key:1,class:"bubble-emoji-medium"},Ee={class:"bubble-label-medium"},Ge={key:2,class:"loading-indicator"},Le={key:0,class:"optimization-section"},Oe={key:0,class:"preview-loading"},Ye=["placeholder","readonly"],Ne={class:"start-button-container"},Ue=["disabled"],We={key:0,class:"safety-stamp"},He={key:0,class:"generation-animation-container"},Qe={key:1,class:"final-output"},qe=["src"],Je=["src"],Xe=["src"],Ze={key:3,class:"model-container"},et=["href"],tt={key:4,class:"unknown-media"},at=["href"],lt=["src"],ot=be({__name:"text_transformation",setup(st){const c=o(""),r=o(""),m=o(null),b=o(null),i=o(""),I=o(!1),u=o(""),_=o(!1),R=o(!1),Y=o(""),w=o(null),d=o("initial"),P=o(!1),v=o(null),y=o("image"),z=o(null),D=o(!1),g=o(0),le=o(null),oe=o(null),M=o(null),N=o(null),U=o(null),K=o(null),W=[{id:"image",label:"Bild",emoji:"ðŸ–¼ï¸",color:"#4CAF50"},{id:"video",label:"Video",emoji:"ðŸŽ¬",color:"#9C27B0"},{id:"sound",label:"Sound",emoji:"ðŸ”Š",color:"#FF9800"},{id:"3d",label:"3D",emoji:"ðŸ§Š",color:"#00BCD4",disabled:!0}],H={image:[{id:"sd35_large",label:`Stable
Diffusion`,emoji:"ðŸŽ¨",color:"#2196F3",description:"Klassische Bildgenerierung",logo:"/logos/logo_stable_diffusion.png",lightBg:!1},{id:"gpt_image_1",label:"GPT Image",emoji:"ðŸŒŸ",color:"#FFC107",description:"Moderne KI-Bilder",logo:"/logos/ChatGPT-Logo.png",lightBg:!0},{id:"gemini_3_pro_image",label:`Gemini 3
Pro`,emoji:"ðŸ”·",color:"#4285F4",description:"Google Gemini Bildgenerierung",lightBg:!1},{id:"qwen",label:"Qwen",emoji:"ðŸŒ¸",color:"#9C27B0",description:"Qwen Vision Model",logo:"/logos/Qwen_logo.png",lightBg:!1}],video:[{id:"ltx_video",label:`LTX
Video`,emoji:"âš¡",color:"#9C27B0",description:"Schnelle lokale Videogenerierung",lightBg:!1},{id:"wan22_video",label:`Wan 2.2
Video`,emoji:"ðŸŽ¬",color:"#E91E63",description:"Hochwertige 720p Videogenerierung mit Wan 2.2 (5B)",lightBg:!1}],sound:[{id:"acenet_t2instrumental",label:`ACE
Instrumental`,emoji:"ðŸŽµ",color:"#FF5722",description:"KI-Musikgenerierung fÃ¼r InstrumentalstÃ¼cke",lightBg:!1},{id:"stableaudio_open",label:`Stable
Audio`,emoji:"ðŸ”Š",color:"#00BCD4",description:"Open-Source Audio-Generierung (max 47s)",lightBg:!1}],"3d":[]},se=o([{id:"generation",label:"Bild",emoji:"ðŸŽ¨",color:"#2196F3",status:"waiting"}]);k(()=>{const t=[...se.value];if(m.value&&t[1]){const e=W.find(a=>a.id===m.value);e&&(t[1]={...t[1],label:e.label,emoji:e.emoji})}return t});const ne=k(()=>m.value?H[m.value]||[]:[]);k(()=>{if(!c.value)return"";const t=100;return c.value.length>t?c.value.substring(0,t)+"...":c.value}),k(()=>{if(!r.value)return"";const t=100;return r.value.length>t?r.value.substring(0,t)+"...":r.value}),k(()=>{if(!i.value)return"";const t=150;return i.value.length>t?i.value.substring(0,t)+"...":i.value}),k(()=>d.value==="initial"?c.value&&m.value&&!I.value:d.value==="optimization_done"?i.value&&u.value&&b.value&&!P.value:!1);const x=k(()=>i.value.trim().length>0),ie=ge(),f=we();me(async()=>{const t=ie.params.configId;if(t){console.log("[Youth Flow] Received configId from Phase1:",t);try{await f.setConfig(t),console.log("[Youth Flow] Config loaded:",f.selectedConfig?.id),await f.loadMetaPromptForLanguage("de"),console.log("[Youth Flow] Meta-prompt loaded:",f.metaPrompt?.substring(0,50)),r.value=f.metaPrompt||"";let e=null;for(const[a,p]of Object.entries(H))if(p.some(S=>S.id===t)){e=a;break}e?(console.log("[Youth Flow] Auto-selecting category:",e,"and config:",t),m.value=e,b.value=t):console.warn("[Youth Flow] ConfigId not found in any category:",t)}catch(e){console.error("[Youth Flow] Initialization error:",e)}}});function F(t,e="start"){if(!t)return;const a=t.getBoundingClientRect();(e==="start"?a.top:a.bottom-window.innerHeight)>0&&t.scrollIntoView({behavior:"smooth",block:e})}async function V(t){m.value=t,b.value=null,await B(),F(K.value,"start")}async function A(t){if(!(!x.value||_.value)){if(b.value=t,!i.value||i.value.trim()===""){u.value=c.value,R.value=!1,d.value="optimization_done",console.log("[Direct Mode] Skipping optimization, using input text directly");return}console.log("[SelectConfig] Triggering optimization for:",t),await ue()}}async function re(){I.value=!0;try{const t=await O.post("/api/schema/pipeline/stage2",{schema:f.selectedConfig?.id||"overdrive",input_text:c.value,context_prompt:r.value||void 0,user_language:"de",safety_level:"youth"});t.data.success?(i.value=t.data.interception_result||t.data.stage2_result||"",d.value="interception_done",console.log("[2-Phase] Interception complete:",i.value.substring(0,60)),await B(),F(K.value,"end")):alert(`Fehler: ${t.data.error}`)}catch(t){console.error("[2-Phase] Interception error:",t);const e=t.response?.data?.error||t.message;alert(`Fehler: ${e}`)}finally{I.value=!1}}async function ue(){_.value=!0;try{const t=await O.post("/api/schema/pipeline/optimize",{input_text:i.value,output_config:b.value});t.data.success?(u.value=t.data.optimized_prompt||"",R.value=t.data.optimization_applied||!1,d.value="optimization_done",console.log("[Optimize] Complete:",u.value.substring(0,60),"| Applied:",R.value)):alert(`Fehler: ${t.data.error}`)}catch(t){console.error("[Optimize] Error:",t);const e=t.response?.data?.error||t.message;alert(`Fehler: ${e}`)}finally{_.value=!1}}async function de(){if(!b.value){alert("Bitte wÃ¤hle ein KI-Modell aus");return}P.value=!0,await B(),setTimeout(()=>F(M.value,"start"),150),await ce()}async function ce(){v.value="",D.value=!1,g.value=0;const t=u.value||i.value||c.value;t===Y.value?(w.value=Math.floor(Math.random()*2147483647),console.log("[Phase 4] Prompt unchanged â†’ New random seed:",w.value)):(w.value===null?(w.value=123456789,console.log("[Phase 4] First run â†’ Default seed:",w.value)):console.log("[Phase 4] Prompt changed â†’ Keeping seed:",w.value),Y.value=t),await new Promise(a=>setTimeout(a,300)),D.value=!0;const e=setInterval(()=>{g.value<85&&(g.value+=Math.random()*15,g.value>85&&(g.value=85))},500);try{const a=await O.post("/api/schema/pipeline/execute",{schema:f.selectedConfig?.id||"overdrive",input_text:t,interception_result:u.value,context_prompt:r.value||void 0,user_language:"de",safety_level:"youth",output_config:b.value,seed:w.value});if(clearInterval(e),a.data.status==="success"){g.value=100;const p=a.data.media_output?.run_id||a.data.run_id,S=a.data.media_output?.media_type||"image";p?(y.value=S,v.value=`/api/media/${S}/${p}`,d.value="generation_done",await B(),setTimeout(()=>F(M.value,"start"),150)):a.data.outputs&&a.data.outputs.length>0&&(y.value="image",v.value=`http://localhost:17802${a.data.outputs[0]}`,d.value="generation_done",await B(),setTimeout(()=>F(M.value,"start"),150))}else alert(`Generation fehlgeschlagen: ${a.data.error}`),g.value=0}catch(a){clearInterval(e),console.error("Pipeline error:",a);const p=a.response?.data?.error||a.message;alert(`Fehler: ${p}`),g.value=0}finally{P.value=!1}}function ve(t){z.value=t}function pe(){f.updateMetaPrompt(r.value),console.log("[Youth Flow] Context prompt edited:",r.value.substring(0,50)+"...")}function Q(t){t&&(t.style.height="auto",t.style.height=t.scrollHeight+4+"px")}return E(()=>f.metaPrompt,t=>{t!==r.value&&(r.value=t||"",console.log("[Youth Flow] Meta-prompt synced from store"))}),E(i,async t=>{await B(),Q(N.value),t.trim().length>0&&d.value==="initial"&&(d.value="interception_done")}),E(u,async()=>{await B(),Q(U.value)}),(t,e)=>(s(),n("div",xe,[l("header",ke,[l("button",{class:"return-button",onClick:e[0]||(e[0]=a=>t.$router.push("/")),title:"ZurÃ¼ck zu Phase 1"}," â† Phase 1 "),e[10]||(e[10]=l("h1",{class:"page-title"},"AI4ArtsEd - AI-Lab",-1))]),l("div",{class:"phase-2a",ref_key:"mainContainerRef",ref:le},[l("section",Ce,[l("div",{class:h(["input-bubble bubble-card",{filled:c.value}])},[e[11]||(e[11]=l("div",{class:"bubble-header"},[l("span",{class:"bubble-icon"},"ðŸ’¡"),l("span",{class:"bubble-label"},"Deine Idee: Worum soll es gehen?")],-1)),T(l("textarea",{"onUpdate:modelValue":e[1]||(e[1]=a=>c.value=a),placeholder:"Ein Fest in meiner StraÃŸe: ...",class:"bubble-textarea",rows:"6"},null,512),[[j,c.value]])],2),l("div",{class:h(["context-bubble bubble-card",{filled:r.value,required:!r.value}])},[e[12]||(e[12]=l("div",{class:"bubble-header"},[l("span",{class:"bubble-icon"},"ðŸ“‹"),l("span",{class:"bubble-label"},"Bestimme Regeln, Material, Besonderheiten")],-1)),T(l("textarea",{"onUpdate:modelValue":e[2]||(e[2]=a=>r.value=a),onInput:pe,placeholder:"Beschreibe alles so, wie es die VÃ¶gel auf den BÃ¤umen wahrnehmen!",class:"bubble-textarea",rows:"6"},null,544),[[j,r.value]])],2)]),l("div",Be,[l("button",{class:h(["start-button",{disabled:!c.value}]),disabled:!c.value,onClick:e[3]||(e[3]=a=>re())},[...e[13]||(e[13]=[l("span",{class:"button-arrows button-arrows-left"},">>>",-1),l("span",{class:"button-text"},"Start",-1),l("span",{class:"button-arrows button-arrows-right"},">>>",-1)])],10,Pe)]),l("section",Ie,[l("div",{class:h(["interception-preview bubble-card",{empty:!i.value,loading:I.value}])},[e[15]||(e[15]=l("div",{class:"bubble-header"},[l("span",{class:"bubble-icon"},"â†’"),l("span",{class:"bubble-label"},"Idee + Regeln = Prompt")],-1)),I.value?(s(),n("div",ze,[...e[14]||(e[14]=[l("div",{class:"spinner-large"},null,-1),l("p",{class:"loading-text"},"Die KI kombiniert jetzt deine Idee mit den Regeln und erstellt einen kreativen Prompt, der zu deinem gewÃ¤hlten Kunststil passt.",-1)])])):T((s(),n("textarea",{key:1,ref_key:"interceptionTextareaRef",ref:N,"onUpdate:modelValue":e[4]||(e[4]=a=>i.value=a),placeholder:"Prompt erscheint nach Start-Klick (oder eigenen Text eingeben)",class:"bubble-textarea auto-resize-textarea",rows:"5"},null,512)),[[j,i.value]])],2)]),l("section",{class:"category-section",ref_key:"categorySectionRef",ref:K},[d.value!=="initial"?(s(),n("h2",Fe,"WÃ¤hle ein Medium aus")):C("",!0),l("div",Me,[(s(),n(q,null,J(W,a=>l("div",{key:a.id,class:h(["category-bubble",{selected:m.value===a.id,disabled:a.disabled}]),style:ee({"--bubble-color":a.color}),onClick:p=>!a.disabled&&V(a.id),role:"button","aria-pressed":m.value===a.id,"aria-disabled":a.disabled,tabindex:a.disabled?-1:0,onKeydown:[$(p=>!a.disabled&&V(a.id),["enter"]),$(te(p=>!a.disabled&&V(a.id),["prevent"]),["space"])]},[l("div",Te,L(a.emoji),1)],46,Se)),64))])],512),l("section",je,[m.value?(s(),n("h2",$e,"wÃ¤hle ein KI-Modell aus")):C("",!0),l("div",Re,[l("div",De,[(s(!0),n(q,null,J(ne.value,a=>(s(),n("div",{key:a.id,class:h(["config-bubble",{selected:b.value===a.id,loading:a.id===b.value&&_.value,"light-bg":a.lightBg,disabled:!x.value}]),style:ee({"--bubble-color":a.color}),onClick:p=>x.value&&A(a.id),role:"button","aria-pressed":b.value===a.id,"aria-disabled":!x.value,tabindex:x.value?0:-1,onKeydown:[$(p=>x.value&&A(a.id),["enter"]),$(te(p=>x.value&&A(a.id),["prevent"]),["space"])]},[a.logo?(s(),n("img",{key:0,src:a.logo,alt:a.label,class:"bubble-logo"},null,8,Ve)):(s(),n("div",Ae,L(a.emoji),1)),l("div",Ee,L(a.label),1),a.id===b.value&&_.value?(s(),n("div",Ge,[...e[16]||(e[16]=[l("div",{class:"spinner"},null,-1)])])):C("",!0)],46,Ke))),128))])])]),b.value?(s(),n("section",Le,[l("div",{class:h(["optimization-preview bubble-card",{empty:!u.value,loading:_.value}])},[e[18]||(e[18]=l("div",{class:"bubble-header"},[l("span",{class:"bubble-icon"},"âœ¨"),l("span",{class:"bubble-label"},"Modell-Optimierter Prompt")],-1)),_.value?(s(),n("div",Oe,[...e[17]||(e[17]=[l("div",{class:"spinner-large"},null,-1),l("p",{class:"loading-text"},"Der Prompt wird jetzt fÃ¼r das gewÃ¤hlte KI-Modell angepasst. Jedes Modell versteht Beschreibungen etwas anders â€“ die KI optimiert den Text fÃ¼r die beste Ausgabe.",-1)])])):T((s(),n("textarea",{key:1,ref_key:"optimizationTextareaRef",ref:U,"onUpdate:modelValue":e[5]||(e[5]=a=>u.value=a),placeholder:u.value?"":"Der optimierte Prompt erscheint nach Modellauswahl.",class:"bubble-textarea auto-resize-textarea",rows:"5",readonly:!u.value},null,8,Ye)),[[j,u.value]])],2)])):C("",!0),l("div",Ne,[l("button",{class:h(["start-button",{disabled:d.value!=="optimization_done"&&d.value!=="generation_done"||!u.value}]),disabled:d.value!=="optimization_done"&&d.value!=="generation_done"||!u.value,onClick:e[6]||(e[6]=a=>de()),ref_key:"startButtonRef",ref:oe},[...e[19]||(e[19]=[l("span",{class:"button-arrows button-arrows-left"},">>>",-1),l("span",{class:"button-text"},"Start",-1),l("span",{class:"button-arrows button-arrows-right"},">>>",-1)])],10,Ue),G(Z,{name:"fade"},{default:X(()=>[D.value?(s(),n("div",We,[...e[20]||(e[20]=[l("div",{class:"stamp-inner"},[l("div",{class:"stamp-icon"},"âœ“"),l("div",{class:"stamp-text"},[ae("Safety"),l("br"),ae("Approved")])],-1)])])):C("",!0)]),_:1})]),l("section",{class:"pipeline-section",ref_key:"pipelineSectionRef",ref:M},[l("div",{class:h(["output-frame",{empty:!P.value&&!v.value,generating:P.value&&!v.value}])},[P.value&&!v.value?(s(),n("div",He,[G(ye,{progress:g.value},null,8,["progress"])])):v.value?(s(),n("div",Qe,[y.value==="image"?(s(),n("img",{key:0,src:v.value,alt:"Generiertes Bild",class:"output-image",onClick:e[7]||(e[7]=a=>ve(v.value))},null,8,qe)):y.value==="video"?(s(),n("video",{key:1,src:v.value,controls:"",class:"output-video"},null,8,Je)):y.value==="audio"||y.value==="music"?(s(),n("audio",{key:2,src:v.value,controls:"",class:"output-audio"},null,8,Xe)):y.value==="3d"?(s(),n("div",Ze,[e[21]||(e[21]=l("div",{class:"model-icon"},"ðŸŽ¨",-1)),l("a",{href:v.value,download:"",class:"download-button"},"3D-Modell herunterladen",8,et),e[22]||(e[22]=l("p",{class:"model-hint"},"Ã–ffne mit Blender oder anderer 3D-Software",-1))])):(s(),n("div",tt,[l("a",{href:v.value,download:"",class:"download-button"},"Datei herunterladen",8,at)]))])):C("",!0)],2)],512)],512),(s(),fe(he,{to:"body"},[G(Z,{name:"modal-fade"},{default:X(()=>[z.value?(s(),n("div",{key:0,class:"fullscreen-modal",onClick:e[9]||(e[9]=a=>z.value=null)},[l("img",{src:z.value,alt:"Dein Bild",class:"fullscreen-image"},null,8,lt),l("button",{class:"close-fullscreen",onClick:e[8]||(e[8]=a=>z.value=null)},"Ã—")])):C("",!0)]),_:1})]))]))}}),dt=_e(ot,[["__scopeId","data-v-276687c7"]]);export{dt as default};
