{
  "_comment": "Backend-Registry for AI4ArtsEd Workshop-Server. Easily configurable for different hardware setups.",

  "backends": {
    "diffusers": {
      "enabled": true,
      "description": "HuggingFace Diffusers for Image Generation",
      "media_types": ["image"],
      "requirements": {
        "min_vram_gb": 8,
        "packages": ["diffusers", "transformers", "accelerate"]
      },
      "config": {
        "cache_dir": null,
        "torch_dtype": "float16",
        "device": "cuda",
        "enable_attention_slicing": true,
        "enable_vae_tiling": false
      }
    },

    "heartmula": {
      "enabled": true,
      "description": "HeartMuLa Music Generation (lyrics + tags to music)",
      "media_types": ["music"],
      "requirements": {
        "min_vram_gb": 12,
        "packages": ["heartlib"],
        "model_path": "~/ai/heartlib/ckpt"
      },
      "config": {
        "device": "cuda",
        "version": "3B",
        "lazy_load": true
      }
    },

    "stable_audio": {
      "enabled": true,
      "description": "Stable Audio Open for Sound Effects and Ambient",
      "media_types": ["audio"],
      "requirements": {
        "min_vram_gb": 8,
        "packages": ["diffusers"],
        "model_id": "stabilityai/stable-audio-open-1.0"
      },
      "config": {
        "torch_dtype": "float16",
        "device": "cuda",
        "max_duration_seconds": 47,
        "default_steps": 100,
        "default_cfg_scale": 7.0
      }
    },

    "ltx_video": {
      "enabled": false,
      "description": "LTX-Video Text-to-Video & Image-to-Video",
      "media_types": ["video"],
      "requirements": {
        "min_vram_gb": 10,
        "packages": ["diffusers", "imageio", "imageio-ffmpeg"],
        "model_id": "Lightricks/LTX-Video"
      },
      "config": {
        "torch_dtype": "bfloat16",
        "device": "cuda"
      }
    },

    "wan_video": {
      "enabled": false,
      "description": "WAN 2.2 Video Generation (5B/14B models)",
      "media_types": ["video"],
      "requirements": {
        "min_vram_gb": 16,
        "packages": ["diffusers", "imageio", "imageio-ffmpeg"]
      },
      "config": {
        "t2v_model_id": "Wan-AI/Wan2.1-T2V-5B-Diffusers",
        "i2v_model_id": "Wan-AI/Wan2.2-I2V-14B-Diffusers",
        "torch_dtype": "float16",
        "device": "cuda"
      }
    },

    "comfyui": {
      "enabled": true,
      "description": "ComfyUI via SwarmUI (Fallback for all media types)",
      "media_types": ["image", "audio", "video", "music"],
      "requirements": {
        "external_service": true,
        "ports": [7801, 7821]
      },
      "config": {
        "api_port": 7801,
        "comfy_port": 7821,
        "auto_start": true,
        "startup_timeout": 120
      }
    },

    "triton": {
      "enabled": false,
      "description": "NVIDIA Triton Inference Server (batched inference)",
      "media_types": ["image"],
      "requirements": {
        "external_service": true,
        "ports": [8000, 8001, 8002]
      },
      "config": {
        "http_url": "localhost:8000",
        "grpc_url": "localhost:8001",
        "metrics_url": "localhost:8002"
      }
    },

    "openai_images": {
      "enabled": false,
      "description": "OpenAI GPT-Image-1 / DALL-E",
      "media_types": ["image"],
      "requirements": {
        "api_key_file": "openai.key"
      },
      "config": {
        "model": "gpt-image-1"
      }
    },

    "openrouter": {
      "enabled": false,
      "description": "OpenRouter (Gemini, etc.)",
      "media_types": ["image"],
      "requirements": {
        "api_key_file": "openrouter.key"
      }
    }
  },

  "priorities": {
    "image": ["diffusers", "triton", "openai_images", "comfyui"],
    "music": ["heartmula", "comfyui"],
    "audio": ["stable_audio", "comfyui"],
    "video": ["ltx_video", "wan_video", "comfyui"]
  },

  "settings": {
    "auto_detect_vram": true,
    "fallback_to_comfyui": true,
    "log_backend_selection": true,
    "comfyui_node_cache_ttl": 300
  }
}
